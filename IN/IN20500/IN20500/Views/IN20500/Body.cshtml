@using Ext.Net;
@using Ext.Net.MVC;
@using HQ.eSkyFramework;
@using HQ.eSkyFramework.HQControl;
@using IN20500;
@{
    Layout = null;
    var X = Html.X();
    var HQ = Html.HQ();
    ViewBag.Title = "IN20500";
}


@(
 Html.X().Viewport().Layout(LayoutType.Fit)
.Items(
        X.FormPanel()
        .Layout(LayoutType.Border)
        .ID("frmMain")  
        .KeyMap(Util.SetupKeyMap())
        .TopBar(Util.SetupToolbar("Print",true,""))
        .Listeners(lst =>
                    {
                        lst.BoxReady.Handler = "firstLoad();";
                        lst.FieldChange.Fn = "frmChange";
                    })
        .FieldDefaults(act => { act.LabelAlign = LabelAlign.Right; act.LabelWidth = 150; })
        .Items(                    
                Html.X().TreePanel().ID("IDTree")
                        .Title(Util.GetLang("Tree"))
                        .Region(Region.West).Flex(2)                                                      
                        .Border(false)                        
                        .Split(true)           
                        .SelectionModel(Html.X().TreeSelectionModel().ID("slmTree").Mode(SelectionMode.Multi))              
                        .Listeners(lst =>
                        {
                                       
                            lst.ItemClick.Fn = "NodeSelected_Change";
                            lst.Render.Handler = "HQ.common.control_render(this,'header')";
                            lst.BeforeItemExpand.Handler = "this.el.mask('Loading...', 'x-mask-loading'); Ext.suspendLayouts();";
                            lst.AfterItemExpand.Handler = "Ext.resumeLayouts(true); this.el.unmask();";
                        })//tree                
                        .BottomBar(
                        X.Toolbar()
                        .Items(
                            X.ToolbarFill()
                    
                            , HQ.Button().ID("btnExpand")
                            .HQLangCode("Expand")
                            .Icon(Icon.BulletTogglePlus)
                            .Handler("btnExpand_click")

                            , X.ToolbarSpacer()
                            , X.ToolbarSeparator()
                            , X.ToolbarSpacer()

                            , HQ.Button().ID("btnCollapse")
                            .HQLangCode("Collapse")
                            .Icon(Icon.BulletToggleMinus)
                            .Handler("btnCollapse_click")

                            , X.ToolbarFill()
                        )
                    )
               , X.Panel()
                .Region(Region.Center).Flex(8)
                .Layout(LayoutType.Border).Border(false)
                .Split(true)                                           
                .Items(
                    X.Panel().ID("pnlHeader").Layout(LayoutType.VBox)
                    .Listeners(l=>
                     {
                            l.Render.Handler = "HQ.common.control_render(this,'header')";
                   
                        })        
                    .Border(false)
                    .MarginSpec("3 5 0 0")
                    .AutoScroll(true)
                    .Region(Region.North)             
                    .Listeners(l =>
                        {
                            //l.Render.Handler = "HQ.common.control_render(this,'header')";
                            l.Resize.Handler = "pnlHeader_Resize();";
                        })
                    .Items(
                        X.Container().Layout(LayoutType.HBox).MarginSpec("3 0 0 0")
                        .Listeners(l =>
                        {
                            l.Render.Handler = "HQ.common.control_render(this,'header')";
                   
                        })                         
                        .Items(                                                                                                            
                            HQ.Combo().ID("cboInvtID").Name("cboInvtID").HQLangCode("InvtID").HQProcedure("IN20500_pcloadInvtID").Tag("X")
                            .HQColumnShow("InvtID,Descr,Descr1,BarCode,Color").DisplayField("InvtID").ValueField("InvtID")
                            .LabelWidth(150).InputWidth(150).HQHeightWidth(400, 500).AllowBlank(false)
                            .HQDBSys(false)//.MaxLength(30).EnforceMaxLength(true)
                            .Triggers(new FieldTrigger() { Icon = TriggerIcon.Clear, HideTrigger = false })
                            .LoadData()
                                .Listeners(lst =>
                                    {
                                        lst.TriggerClick.Handler = "if (index == 0) { this.clearValue();}";
                                        lst.Change.Fn = "cboInvtID_Change";
                                        //lst.Select.Fn = "cboInvtID_Select";
                                        //lst.Focus.Fn = "Focus1_Change";
                                    })

                            , HQ.Button().ID("btnCopy").Width(100).MarginSpec("0 5 0 5")
                                 .HQLangCode("CopyFrom").Listeners(p =>
                                 {
                                    p.Click.Fn = "CopyForm_Click";
                                 })
                                
                                 
                             , HQ.TextBox().ID("txtBarCode").Name("txtBarCode").HQLangCode("InvtID").Tag("X")
                            .InputWidth(90).MaxLength(20).EnforceMaxLength(true).LabelWidth(85)
                            
                            
                            , HQ.Combo().ID("cboApproveStatus").Name("cboApproveStatus").HQLangCode("ApproveStatus").HQProcedure("IN20500_pcApproveStatus")
                            .HQColumnShow("Descr").DisplayField("Descr").ValueField("Code").DataIndex("ApproveStatus").ReadOnly(true).Tag("X")//.SelectedItems("H")//.SetValueAndFireSelect("H")
                            .HQHeightWidth(400, 300).LabelWidth(150).InputWidth(150)
                            .HQDBSys(false).ForceSelection(false)//.MaxLength(5).EnforceMaxLength(true)                           
                             .HQParam(new StoreParameterCollection() 
                                { 
                                    new StoreParameter() { Name = "@LangID", Value = "HQ.langID", Mode = ParameterMode.Raw }
                                })
                            .LoadData()
                            .Listeners(lst =>
                                {
                                    lst.TriggerClick.Handler = "if (index == 0) { this.clearValue();}";
                                    lst.Change.Fn = "cboApproveStatus_Change";
                                    lst.Focus.Handler = "this.forceSelection = true;";
                                    
                                })

                            )
                            
                            ,X.Container().Layout(LayoutType.HBox).MarginSpec("3 0 0 0")                          
                            .Items(
                            
                                  HQ.TextBox().ID("txtDescr").Name("txtDescr").HQLangCode("Descr").DataIndex("Descr")
                                .Width(595).MaxLength(100).EnforceMaxLength(true).AllowBlank(false)                              
                            
                                 , HQ.Combo().ID("cboHandle").Name("cboHandle").HQLangCode("Handle").HQProcedure("IN20500_pcHandle")
                                .HQColumnShow("Descr").DisplayField("Descr").ValueField("Code")//.DataIndex("Handle")
                                .HQHeightWidth(400, 300).LabelWidth(150).InputWidth(150).HQValue("N",false).Tag("X").ForceSelection(true)
                                .HQDBSys(false).ForceSelection(true)//.MaxLength(5).EnforceMaxLength(true)
                                .Triggers(new FieldTrigger() { Icon = TriggerIcon.Clear, HideTrigger = false })
                                .HQParam(new StoreParameterCollection()
                                    {
                                        
                                        new StoreParameter() { Name = "@Status", Value = "App.cboApproveStatus.value", Mode = ParameterMode.Raw },
                                        new StoreParameter() { Name = "@UserID",  Value ="HQ.userName", Mode = ParameterMode.Raw },
                                        new StoreParameter() { Name = "@LangID", Value = "HQ.langID", Mode = ParameterMode.Raw }
                                    })
                                .LoadData()
                                .Listeners(lst =>
                                    {
                                        lst.TriggerClick.Handler = "if (index == 0) { this.clearValue();}";
                                        lst.Focus.Handler = "this.forceSelection = true;";
                                        //lst.Focus.Fn = "Focus1_Change";
                                    })
                            
                            
                            
                                )
                                
                                
                                ,X.Container().Layout(LayoutType.HBox).MarginSpec("3 0 0 0")                                
                                .Items(
                                
                                
                                HQ.TextBox().ID("txtDescr1").Name("txtDescr1").HQLangCode("Descr1").DataIndex("Descr1")
                                .Width(595).MaxLength(100).EnforceMaxLength(true)
                            

                               
                                
                                )
                                
                                ,X.Container().Layout(LayoutType.HBox).MarginSpec("3 0 0 0")                                
                                .Items(
                                
                                    HQ.Combo().ID("cboStatus").Name("cboStatus").HQLangCode("Status").HQProcedure("IN20500_pcStatus")
                                    .HQColumnShow("Descr").DisplayField("Descr").ValueField("Code").DataIndex("Status")
                                    .Width(400).HQHeightWidth(400, 300).ReadOnly(true)//.HQA
                                        .HQParam(new StoreParameterCollection() 
                                    { 
                                        new StoreParameter() { Name = "@LangID", Value = "HQ.langID", Mode = ParameterMode.Raw }
                                    })
                                    .HQDBSys(false).ForceSelection(false)//.MaxLength(30).EnforceMaxLength(true)
                                    //.Triggers(new FieldTrigger() { Icon = TriggerIcon.Clear, HideTrigger = false })                                   
                                    .LoadData()
                                    .Listeners(lst =>
                                        {
                                            lst.TriggerClick.Handler = "if (index == 0) { this.clearValue();}";
                                            lst.Focus.Handler = "this.forceSelection = true;";
                                            //lst.Change.Fn = "cboStatus_Change";
                                        })
                                
                                    
                                     ,HQ.Checkbox().ID("chkPublic").Name("chkPublic").HQLangCode("Public").DataIndex("Public")
                                    .Width(400).MarginSpec("0 0 0 10")
                                    .Listeners(lst=>
                                        {
                                            lst.Change.Fn = "chkPublic_Change";
                           
                                        })                                                                                                                                                                                          
                                )
                            )//pnlHeader 
                                , X.Container().MarginSpec("5 0 0 0")
                                , X.TabPanel().Border(false).Region(Region.Center)                                                                                                                           
                                    .ID("tabDetail")
                                    .Listeners(p =>
                                    {
                                        p.TabChange.Fn = "Tab_Change";
                                    })
                                    .Items(
                                            X.Panel().Listeners(l =>
                                                {
                                                    //l.Render.Handler = "HQ.common.control_render(this,'header')";

                                                })
                                            .ID("tabInfo").Layout(LayoutType.HBox).Border(false).AutoScroll(true)
                                            .Title(Util.GetLang("DfltInfo"))
                                            .Padding(0)
                                            .Items(
                                                X.Panel()
                                                .Layout(LayoutType.VBox).Border(false)                                             
                                                .BodyPadding(0)
                                                .Items(
                                                     HQ.Combo().ID("cboClassID").Name("cboClassID").HQLangCode("ClassID").HQProcedure("IN20500_pcProductCLassAll")
                                                    .HQColumnShow("ClassID,Descr").DisplayField("Descr").ValueField("ClassID").DataIndex("ClassID")
                                                    .Width(400).HQHeightWidth(400, 300).AllowBlank(false)
                                                    .HQDBSys(false).ForceSelection(false)//.MaxLength(30).EnforceMaxLength(true)
                                                    .Triggers(new FieldTrigger() { Icon = TriggerIcon.Clear, HideTrigger = false })
                                                    .HQParam(new StoreParameterCollection()
                                                    {
                                                        // new StoreParameter() { Name = "@LangID", Value = "HQ.langID", Mode = ParameterMode.Raw }
                                                    })
                                                    .LoadData()
                                                    .Listeners(lst =>
                                                        {
                                                            lst.TriggerClick.Handler = "if (index == 0) { this.clearValue();}";
                                                            lst.Change.Fn = "cboClassID_Change";
                                                            lst.Focus.Handler = "this.forceSelection = true;";
                                                            lst.Render.Handler = "HQ.common.control_render(this,'ClassID')";
                                                        })

                                                    , HQ.Combo().ID("cboPriceClassID").Name("cboPriceClassID").HQLangCode("PriceClassID").HQProcedure("IN20500_pcItemPriceClass")
                                                    .HQColumnShow("PriceClassID,Descr").DisplayField("Descr").ValueField("PriceClassID").DataIndex("PriceClassID")
                                                    .Width(400).HQHeightWidth(400, 300)
                                                    .HQDBSys(false).ForceSelection(false)//.MaxLength(30).EnforceMaxLength(true)
                                                    .Triggers(new FieldTrigger() { Icon = TriggerIcon.Clear, HideTrigger = false })
                                                    .LoadData()
                                                    .Listeners(lst =>
                                                        {
                                                            lst.TriggerClick.Handler = "if (index == 0) { this.clearValue();}";
                                                            lst.Focus.Handler = "this.forceSelection = true;";
                                                        })


                                                    , HQ.Combo().ID("cboInvtType").Name("cboInvtType").HQLangCode("Type").HQProcedure("IN20500_pcIvntType")
                                                    .HQColumnShow("Descr").DisplayField("Descr").ValueField("Code").DataIndex("InvtType")
                                                    .Width(400).HQHeightWidth(400, 300).AllowBlank(false)
                                                    .HQDBSys(false).ForceSelection(false)//.MaxLength(30).EnforceMaxLength(true)
                                                    .Triggers(new FieldTrigger() { Icon = TriggerIcon.Clear, HideTrigger = false })
                                                    .HQParam(new StoreParameterCollection() 
                                                    { 
                                                        new StoreParameter() { Name = "@LangID", Value = "HQ.langID", Mode = ParameterMode.Raw }
                                                    })
                                                    .LoadData()
                                                    .Listeners(lst =>
                                                        {
                                                            lst.TriggerClick.Handler = "if (index == 0) { this.clearValue();}";
                                                            lst.Focus.Handler = "this.forceSelection = true;";
                                                            //lst.Focus.Fn = "Focus1_Change";
                                                        })


                                                    , HQ.Combo().ID("cboSource").Name("cboSource").HQLangCode("Source").HQProcedure("IN20500_pcSource")
                                                    .HQColumnShow("Descr").DisplayField("Descr").ValueField("Code").DataIndex("Source")
                                                    .Width(400).HQHeightWidth(400, 300).AllowBlank(false)
                                                    .HQDBSys(false).ForceSelection(false)//.MaxLength(30).EnforceMaxLength(true)
                                                    .Triggers(new FieldTrigger() { Icon = TriggerIcon.Clear, HideTrigger = false })
                                                    .HQParam(new StoreParameterCollection() 
                                                    { 
                                                        new StoreParameter() { Name = "@LangID", Value = "HQ.langID", Mode = ParameterMode.Raw }
                                                    })
                                                    .LoadData()
                                                    .Listeners(lst =>
                                                        {
                                                            lst.TriggerClick.Handler = "if (index == 0) { this.clearValue();}";
                                                            lst.Focus.Handler = "this.forceSelection = true;";
                                                            //lst.Focus.Fn = "Focus1_Change";
                                                        })

                                                     , HQ.Combo().ID("cboValMthd").Name("cboValMthd").HQLangCode("ValMthd").HQProcedure("IN20500_pcValMthd")
                                                    .HQColumnShow("Descr").DisplayField("Descr").ValueField("Code").DataIndex("ValMthd")
                                                    .Width(400).HQHeightWidth(400, 300).AllowBlank(false)
                                                    .HQDBSys(false).ForceSelection(false)//.MaxLength(30).EnforceMaxLength(true)
                                                    .Triggers(new FieldTrigger() { Icon = TriggerIcon.Clear, HideTrigger = false })
                                                    .HQParam(new StoreParameterCollection() 
                                                    { 
                                                        new StoreParameter() { Name = "@LangID", Value = "HQ.langID", Mode = ParameterMode.Raw }
                                                    })
                                                    .LoadData()
                                                    .Listeners(lst =>
                                                        {
                                                            lst.TriggerClick.Handler = "if (index == 0) { this.clearValue();}";
                                                            lst.Focus.Handler = "this.forceSelection = true;";
                                                            //lst.Focus.Fn = "Focus1_Change";
                                                        })

                                                     , HQ.Combo().ID("cboLotSerTrack").Name("cboLotSerTrack").HQLangCode("LotSerTrack").HQProcedure("IN20500_pcLotSerTrack")
                                                    .HQColumnShow("Code,Descr").DisplayField("Descr").ValueField("Code").DataIndex("LotSerTrack")
                                                    .Width(400).HQHeightWidth(400, 300).AllowBlank(false)
                                                    .HQDBSys(false).ForceSelection(false)//.MaxLength(30).EnforceMaxLength(true)
                                                    .Triggers(new FieldTrigger() { Icon = TriggerIcon.Clear, HideTrigger = false })
                                                    .HQParam(new StoreParameterCollection() 
                                                    { 
                                                        new StoreParameter() { Name = "@LangID", Value = "HQ.langID", Mode = ParameterMode.Raw }
                                                    })
                                                    .LoadData()
                                                    .Listeners(lst =>
                                                        {
                                                            lst.TriggerClick.Handler = "if (index == 0) { this.clearValue();}";
                                                            lst.Change.Fn = "cboLotSerTrack_Change";
                                                            lst.Focus.Handler = "this.forceSelection = true;";
                                                        })


                                                     , HQ.Combo().ID("cboBuyer").Name("cboBuyer").HQLangCode("Buyer").HQProcedure("IN20500_pcBuyerAll")
                                                    .HQColumnShow("Buyer,BuyerName").DisplayField("Buyer").ValueField("Buyer").DataIndex("Buyer")
                                                    .Width(400).HQHeightWidth(400, 300)
                                                    .HQDBSys(false).ForceSelection(false)//.MaxLength(30).EnforceMaxLength(true)
                                                    .Triggers(new FieldTrigger() { Icon = TriggerIcon.Clear, HideTrigger = false })

                                                    .LoadData()
                                                    .Listeners(lst =>
                                                        {
                                                            lst.TriggerClick.Handler = "if (index == 0) { this.clearValue();}";
                                                            lst.Focus.Handler = "this.forceSelection = true;";
                                                            //lst.Focus.Fn = "Focus1_Change";
                                                        })



                                                        // sua store cua cai nay lai sau cung voi ben IN20200
                                                       , HQ.Combo().ID("cboStkUnit").Name("cboStkUnit").HQLangCode("StkUnit").HQProcedure("IN20500_pcgetToUnit")
                                                        .HQColumnShow("ToUnit").DisplayField("ToUnit").ValueField("ToUnit").DataIndex("StkUnit")
                                                        .Width(400).HQHeightWidth(400, 300).AllowBlank(false)
                                                        .HQDBSys(false).ForceSelection(false)//.MaxLength(30).EnforceMaxLength(true)
                                                        .Triggers(new FieldTrigger() { Icon = TriggerIcon.Clear, HideTrigger = false })
                                                            .HQParam(new StoreParameterCollection()
                                                            {
                                                                //new StoreParameter() { Name = "@ClassID", Value = "App.cboClassID.value", Mode = ParameterMode.Raw }
                                                            })
                                                        .LoadData()
                                                        .Listeners(lst =>
                                                            {
                                                                lst.TriggerClick.Handler = "if (index == 0) { this.clearValue();}";
                                                                lst.Change.Fn = "cboStkUnit_Change";
                                                                lst.Focus.Handler = "this.forceSelection = true;";
                                                            })

                                                          , HQ.Combo().ID("cboDfltPOUnit").Name("cboDfltPOUnit").HQLangCode("POUnit").HQProcedure("IN20500_pcGetDfltPOUnitSOUnit")
                                                            .HQColumnShow("FromUnit").DisplayField("FromUnit").ValueField("FromUnit").DataIndex("DfltPOUnit")
                                                            .Width(400).HQHeightWidth(400, 300).AllowBlank(false)
                                                            .HQDBSys(false).ForceSelection(false)//.MaxLength(30).EnforceMaxLength(true)
                                                            .Triggers(new FieldTrigger() { Icon = TriggerIcon.Clear, HideTrigger = false })
                                                                .HQParam(new StoreParameterCollection() 
                                                            { 
                                                                new StoreParameter() { Name = "@ToUnit", Value = "App.cboStkUnit.value", Mode = ParameterMode.Raw }
                                                            })
                                                            .LoadData()
                                                            .Listeners(lst =>
                                                                {
                                                                    lst.TriggerClick.Handler = "if (index == 0) { this.clearValue();}";
                                                                    lst.Focus.Handler = "this.forceSelection = true;";
                                                                    //lst.Focus.Fn = "Focus1_Change";
                                                                })



                                                            , HQ.Combo().ID("cboDfltSOUnit").Name("cboDfltSOUnit").HQLangCode("SOUnit").HQProcedure("IN20500_pcGetDfltPOUnitSOUnit")
                                                            .HQColumnShow("FromUnit").DisplayField("FromUnit").ValueField("FromUnit").DataIndex("DfltSOUnit")
                                                            .Width(400).HQHeightWidth(400, 300).AllowBlank(false)
                                                            .HQDBSys(false).ForceSelection(false)//.MaxLength(30).EnforceMaxLength(true)
                                                            .Triggers(new FieldTrigger() { Icon = TriggerIcon.Clear, HideTrigger = false })
                                                                .HQParam(new StoreParameterCollection() 
                                                            { 
                                                                new StoreParameter() { Name = "@ToUnit", Value = "App.cboStkUnit.value", Mode = ParameterMode.Raw }
                                                            })
                                                            .LoadData()
                                                            .Listeners(lst =>
                                                                {
                                                                    lst.TriggerClick.Handler = "if (index == 0) { this.clearValue();}";
                                                                    lst.Focus.Handler = "this.forceSelection = true;";
                                                                    //lst.Focus.Fn = "Focus1_Change";
                                                                })



                                                              , HQ.Combo().ID("cboMaterialType").Name("cboMaterialType").HQLangCode("MaterialType").HQProcedure("IN20500_pcMaterialTypeAll")
                                                            .HQColumnShow("MaterialType,Descr").DisplayField("Descr").ValueField("MaterialType").DataIndex("MaterialType")
                                                            .Width(400).HQHeightWidth(400, 300).AllowBlank(true)
                                                            .HQDBSys(false).ForceSelection(false)//.MaxLength(30).EnforceMaxLength(true)
                                                            .Triggers(new FieldTrigger() { Icon = TriggerIcon.Clear, HideTrigger = false })

                                                            .LoadData()
                                                            .Listeners(lst =>
                                                                {
                                                                    lst.TriggerClick.Handler = "if (index == 0) { this.clearValue();}";
                                                                    lst.Focus.Handler = "this.forceSelection = true;";
                                                                    //lst.Focus.Fn = "Focus1_Change";
                                                                })


                                                                , HQ.Combo().ID("cboDfltSlsTaxCat").Name("cboDfltSlsTaxCat").HQLangCode("TaxCat").HQProcedure("IN20500_pcTaxCat")
                                                                .HQColumnShow("CatID,Descr").DisplayField("CatID").ValueField("CatID").DataIndex("TaxCat")
                                                                .Width(400).HQHeightWidth(400, 300).AllowBlank(false)
                                                                .HQDBSys(false).ForceSelection(false)//.MaxLength(30).EnforceMaxLength(true)
                                                                .Triggers(new FieldTrigger() { Icon = TriggerIcon.Clear, HideTrigger = false })

                                                                .LoadData()
                                                                .Listeners(lst =>
                                                                    {
                                                                        lst.TriggerClick.Handler = "if (index == 0) { this.clearValue();}";
                                                                        lst.Focus.Handler = "this.forceSelection = true;";
                                                                        //lst.Focus.Fn = "Focus1_Change";
                                                                    })



                                                    )
                                                    , X.Panel()
                                                            .Layout(LayoutType.Anchor).Border(false)
                                                            .DefaultAnchor("100%").MarginSpec("3 10 10 10")
                                                            .BodyPadding(0)
                                                            .Items(

                                                                  X.Container().Layout(LayoutType.HBox).MarginSpec("3 0 0 0")
                                                                    .Items(

                                                                    X.Container().Layout(LayoutType.VBox)
                                                                .Items(

                                                                        HQ.Checkbox().ID("chkStkItem").Name("chkStkItem").HQLangCode("StkItem").DataIndex("StkItem")
                                                                    .Width(400).MarginSpec("3 0 0 5")
                                                                    .Listeners(lst =>
                                                                        {
                                                                            //lst.Change.Fn = "chkPublic_Change";

                                                                        })
                                                                         //Image

                                                                        , X.Hidden().ID("hdnPPCStorePicReq").DataIndex("Picture")
                                                                        , X.Image().ID("imgPPCStorePicReq").Width(200).Height(200)

                                                                       , X.Container().Layout(LayoutType.HBox).MarginSpec("3 0 0 0")
                                                                       .Items(


                                                                            X.FileUploadField().ID("fupPPCStorePicReq").Icon(Icon.ImageAdd)
                                                                            .ButtonText(Util.GetLang("ChooseImage"))
                                                                            .ButtonOnly(true).Width(100)
                                                                            .Listeners(l =>
                                                                                {
                                                                                    l.Change.Fn = "fupPPCStorePicReq_Change";
                                                                                })

                                                                            , X.Button().ID("btnClearImage").Icon(Icon.ImageDelete).Text(Util.GetLang("ClearImage"))
                                                                            .Listeners(lst => lst.Click.Fn = "btnClearImage_Click").Width(100)

                                                                            , HQ.TextBox().ID("txtImageChange").Name("txtImageChange").Hidden(true)

                                                                           )

                                                                       )
                                                                         //Media
                                                                        , X.Container().Layout(LayoutType.VBox).MarginSpec("25 0 0 -190")
                                                                        .Items(

                                                                            X.Hidden().ID("hdnPPCStoreMediaReq").DataIndex("Media")
                                                                            , X.Image().ID("imgPPCStoreMediaReq").Width(200).Height(200)
                                                                            .Listeners(l =>
                                                                                        {
                                                                                            l.Click.Fn = "PlayVideo";
                                                                                        })

                                                                            , X.Container().Layout(LayoutType.HBox)
                                                                            .Items(


                                                                                    X.FileUploadField().ID("fupPPCStoreMediaReq").Icon(Icon.ImageAdd).ButtonText(Util.GetLang("ChooseMedia"))
                                                                                    .ButtonOnly(true).MarginSpec("3 0 0 0").Width(100)
                                                                                    .Listeners(l =>
                                                                                        {
                                                                                            l.Change.Fn = "fupPPCStoreMediaReq_Change";
                                                                                        })

                                                                                     , X.Button().ID("btnDeleteMedia").Icon(Icon.ImageDelete).Text(Util.GetLang("DeleteMedia")).MarginSpec("3 0 0 0")
                                                                                    .Listeners(lst => lst.Click.Fn = "btnDeleteMedia_Click").Width(100)



                                                                                  )
                                                                           )

                                                                    )

                                                                )
                                           )// ngoac ket thuc tab 1  

                                          , X.Panel()
                                            .ID("tabAttribute").Layout(LayoutType.VBox)
                                            .Title(Util.GetLang("Attribute")).Border(false).AutoScroll(true)                                         
                                            .Listeners(l =>
                                                    {
                                                        l.Render.Handler = "HQ.common.control_render(this,'header')";
                                                    })
                                            .Items(

                                             X.Container().Layout(LayoutType.HBox).MarginSpec("3 0 0 0")
                                            .Items(

                                                    HQ.TextBox().ID("txtColor").Name("txtColor").HQLangCode("Color").DataIndex("Color")
                                                    .LabelWidth(150).InputWidth(150).MaxLength(20).EnforceMaxLength(true)

                                                    , HQ.NumberField().ID("txtPrePayPct").Name("txtPrePayPct").HQLangCode("PrePayPct").DataIndex("PrePayPct")
                                                    .LabelWidth(150).InputWidth(150).DecimalPrecision(0).MinValue(0)

                                                  )

                                            , X.Container().Layout(LayoutType.HBox).MarginSpec("3 0 0 0")
                                            .Items(

                                                    HQ.TextBox().ID("txtSize").Name("txtSize").HQLangCode("Size").DataIndex("Size")
                                                    .LabelWidth(150).InputWidth(150).MaxLength(10).EnforceMaxLength(true)

                                                    , HQ.NumberField().ID("txtPOFee").Name("txtPOFee").HQLangCode("POFee").DataIndex("POFee")
                                                    .LabelWidth(150).InputWidth(150).DecimalPrecision(0).MinValue(0)
                                                  )

                                            , X.Container().Layout(LayoutType.HBox).MarginSpec("3 0 0 0")
                                            .Items(

                                                     HQ.Combo().ID("cboStyle").Name("cboStyle").HQLangCode("Style").HQProcedure("IN20500_pcStyle")
                                                    .HQColumnShow("Nganh").DisplayField("Nganh").ValueField("Ma").DataIndex("Style")
                                                    .LabelWidth(150).InputWidth(150).HQHeightWidth(400, 300)
                                                    .HQDBSys(false).ForceSelection(false)//.MaxLength(30).EnforceMaxLength(true)
                                                    .Triggers(new FieldTrigger() { Icon = TriggerIcon.Clear, HideTrigger = false })

                                                    .LoadData()
                                                    .Listeners(lst =>
                                                        {
                                                            lst.TriggerClick.Handler = "if (index == 0) { this.clearValue();}";
                                                            lst.Focus.Handler = "this.forceSelection = true;";
                                                            //lst.Focus.Fn = "Focus1_Change";
                                                        })


                                                    , HQ.NumberField().ID("txtSOFee").Name("txtSOFee").HQLangCode("SOFee").DataIndex("SOFee")
                                                    .LabelWidth(150).InputWidth(150).DecimalPrecision(0).MinValue(0)

                                                  )

                                              , X.Container().Layout(LayoutType.HBox).MarginSpec("3 0 0 0")
                                            .Items(

                                                    HQ.NumberField().ID("txtStkVol").Name("txtStkVol").HQLangCode("StkVol").DataIndex("StkVol")
                                                    .LabelWidth(150).InputWidth(150).DecimalPrecision(0).MinValue(0)


                                                     , HQ.Combo().ID("cboVendor1").Name("cboVendor1").HQLangCode("Vendor1").HQProcedure("IN20500_pcVendor")
                                                    .HQColumnShow("VendID,name").DisplayField("name").ValueField("VendID").DataIndex("VendID1")
                                                    .LabelWidth(150).InputWidth(150).HQHeightWidth(400, 300)
                                                    .HQDBSys(false).ForceSelection(false)//.MaxLength(30).EnforceMaxLength(true)
                                                    .Triggers(new FieldTrigger() { Icon = TriggerIcon.Clear, HideTrigger = false })

                                                    .LoadData()
                                                    .Listeners(lst =>
                                                        {
                                                            lst.TriggerClick.Handler = "if (index == 0) { this.clearValue();}";
                                                            lst.Focus.Handler = "this.forceSelection = true;";
                                                            //lst.Focus.Fn = "Focus1_Change";
                                                        })




                                                  )

                                                  , X.Container().Layout(LayoutType.HBox).MarginSpec("3 0 0 0")
                                                  .Items(

                                                    HQ.NumberField().ID("txtStkWt").Name("txtStkWt").HQLangCode("StkWt").DataIndex("StkWt")
                                                    .LabelWidth(150).InputWidth(150).DecimalPrecision(0).MinValue(0)


                                                     , HQ.Combo().ID("cboVendor2").Name("cboVendor2").HQLangCode("Vendor2").HQProcedure("IN20500_pcVendor")
                                                    .HQColumnShow("VendID,name").DisplayField("name").ValueField("VendID").DataIndex("VendID2")
                                                    .LabelWidth(150).InputWidth(150).HQHeightWidth(400, 300)
                                                    .HQDBSys(false).ForceSelection(false)//.MaxLength(30).EnforceMaxLength(true)
                                                    .Triggers(new FieldTrigger() { Icon = TriggerIcon.Clear, HideTrigger = false })

                                                    .LoadData()
                                                    .Listeners(lst =>
                                                        {
                                                            lst.TriggerClick.Handler = "if (index == 0) { this.clearValue();}";
                                                            lst.Focus.Handler = "this.forceSelection = true;";
                                                            //lst.Focus.Fn = "Focus1_Change";
                                                        })




                                                  )

                                                  , X.Container().Layout(LayoutType.HBox).MarginSpec("3 0 0 0")
                                                .Items(
        // cai nay cung sua sau
                                                     HQ.Combo().ID("cboStkWtUnit").Name("cboStkWtUnit").HQLangCode("StkWtUnit").HQProcedure("IN20500_pcGetToUnit")
                                                    .HQColumnShow("ToUnit").DisplayField("ToUnit").ValueField("ToUnit").DataIndex("StkWtUnit")
                                                    .LabelWidth(150).InputWidth(150).HQHeightWidth(400, 300)
                                                    .HQDBSys(false).ForceSelection(false)//.MaxLength(30).EnforceMaxLength(true)
                                                    .Triggers(new FieldTrigger() { Icon = TriggerIcon.Clear, HideTrigger = false })

                                                    .LoadData()
                                                    .Listeners(lst =>
                                                        {
                                                            lst.TriggerClick.Handler = "if (index == 0) { this.clearValue();}";
                                                            lst.Focus.Handler = "this.forceSelection = true;";
                                                            //lst.Focus.Fn = "Focus1_Change";
                                                        })


                                                    , HQ.NumberField().ID("txtLossRate00").Name("txtLossRate00").HQLangCode("LossRate1").DataIndex("LossRate00")
                                                    .LabelWidth(150).InputWidth(150).DecimalPrecision(0).MinValue(0)

                                                  )

                                                  , X.Container().Layout(LayoutType.HBox).MarginSpec("3 0 0 0")
                                                .Items(

                                                     HQ.NumberField().ID("txtSOPrice").Name("txtSOPrice").HQLangCode("SOPrice").DataIndex("SOPrice")
                                                    .LabelWidth(150).InputWidth(150).DecimalPrecision(0).MinValue(0)


                                                    , HQ.NumberField().ID("txtLossRate01").Name("txtLossRate01").HQLangCode("LossRate2").DataIndex("LossRate01")
                                                    .LabelWidth(150).InputWidth(150).DecimalPrecision(0).MinValue(0)

                                                  )

                                                  , X.Container().Layout(LayoutType.HBox).MarginSpec("3 0 0 0")
                                                .Items(

                                                     HQ.NumberField().ID("txtPOPrice").Name("txtPOPrice").HQLangCode("POPrice").DataIndex("POPrice")
                                                    .LabelWidth(150).InputWidth(150).DecimalPrecision(0).MinValue(0)


                                                    , HQ.NumberField().ID("txtLossRate02").Name("txtLossRate02").HQLangCode("LossRate3").DataIndex("LossRate02")
                                                    .LabelWidth(150).InputWidth(150).DecimalPrecision(0).MinValue(0)

                                                  )

                                                  , X.Container().Layout(LayoutType.HBox).MarginSpec("3 0 0 0")
                                                .Items(

                                                     HQ.NumberField().ID("txtIRSftyStkDays").Name("txtIRSftyStkDays").HQLangCode("SftyStkDay").DataIndex("IRSftyStkDays")
                                                    .LabelWidth(150).InputWidth(150).DecimalPrecision(0).MinValue(0)


                                                    , HQ.NumberField().ID("txtLossRate03").Name("txtLossRate03").HQLangCode("LossRate4").DataIndex("LossRate03")
                                                    .LabelWidth(150).InputWidth(150).DecimalPrecision(0).MinValue(0)

                                                  )

                                                  , HQ.NumberField().ID("txtIRSftyStkPct").Name("txtIRSftyStkPct").HQLangCode("SftyStkPct").DataIndex("IRSftyStkPct").MarginSpec("3 0 0 0")
                                                   .LabelWidth(150).InputWidth(150).DecimalPrecision(0).MinValue(0)

                                                  , HQ.NumberField().ID("txtIRSftyStkQty").Name("txtIRSftyStkQty").HQLangCode("SftyStkQty").DataIndex("IRSftyStkQty").MarginSpec("3 0 0 0")
                                                    .LabelWidth(150).InputWidth(150).DecimalPrecision(0).MinValue(0)

                                                  , HQ.NumberField().ID("txtIROverStkQty").Name("txtIROverStkQty").HQLangCode("OverStkQty").DataIndex("IROverStkQty").MarginSpec("3 0 0 0")
                                                  .LabelWidth(150).InputWidth(150).DecimalPrecision(0).MinValue(0)



                                          // ngoac ket thuc tab 2              
                                           )
                                           , X.Panel()
                                                .ID("tabLotSerial").AutoScroll(true) 
                                                .Layout(LayoutType.VBox)
                                                .Border(false)
                                                .AnchorHorizontal("100%")
                                                .AnchorVertical("100%")
                                                .Padding(5)
                                                .Title(Util.GetLang("LotSerial"))
                                                .CloseAction(CloseAction.Hide)
                                                .Disabled(true)
                                                .Listeners(l =>
                                                    {
                                                        l.Render.Handler = "HQ.common.control_render(this,'header')";

                                                    })
                                                .Items(
                                                        
                                                        X.Container().Layout(LayoutType.HBox).MarginSpec("5 0 5 0")
                                                        .Items(
                                                            HQ.Combo().ID("cboSerAssign").Name("cboSerAssign").HQLangCode("Assignment").HQProcedure("IN20500_pcSerAssign")
                                                            .HQColumnShow("Descr").DisplayField("Descr").ValueField("Code").DataIndex("SerAssign").MarginSpec("0 0 0 11")
                                                            .Width(400).HQHeightWidth(400, 300)
                                                            .HQDBSys(false).ForceSelection(false)//.MaxLength(30).EnforceMaxLength(true).AllowBlank(true)
                                                            .Triggers(new FieldTrigger() { Icon = TriggerIcon.Clear, HideTrigger = false })
                                                            .HQParam(new StoreParameterCollection() 
                                                            { 
                                                                new StoreParameter() { Name = "@LangID", Value = "HQ.langID", Mode = ParameterMode.Raw }
                                                            })
                                                            .LoadData()
                                                            .Listeners(lst =>
                                                                {
                                                                    lst.TriggerClick.Handler = "if (index == 0) { this.clearValue();}";
                                                                    lst.Focus.Handler = "this.forceSelection = true;";
                                                                    //lst.Focus.Fn = "Focus1_Change";
                                                                })

                                                              ,HQ.Checkbox().ID("chkLotSerRcptAuto").Name("chkLotSerRcptAuto").HQLangCode("LotSerRcptAuto").DataIndex("LotSerRcptAuto")
                                                              .Width(400).MarginSpec("0 0 0 10")
                              
                                                                
                                                                
                                                        )

                                                        , HQ.Combo().ID("cboLotSerIssMthd").Name("cboLotSerIssMthd").HQLangCode("IssMthd").HQProcedure("IN20500_pcLotSerIssMthd").MarginSpec("0 0 0 11")
                                                        .HQColumnShow("Descr").DisplayField("Descr").ValueField("Code").DataIndex("LotSerIssMthd")
                                                        .Width(400).HQHeightWidth(400, 300)
                                                        .HQDBSys(false).ForceSelection(false)//.MaxLength(30).EnforceMaxLength(true).AllowBlank(true)
                                                        .Triggers(new FieldTrigger() { Icon = TriggerIcon.Clear, HideTrigger = false })
                                                        .HQParam(new StoreParameterCollection() 
                                                        { 
                                                            new StoreParameter() { Name = "@LangID", Value = "HQ.langID", Mode = ParameterMode.Raw }
                                                        })
                                                        .LoadData()
                                                        .Listeners(lst =>
                                                            {
                                                                lst.TriggerClick.Handler = "if (index == 0) { this.clearValue();}";
                                                                lst.Focus.Handler = "this.forceSelection = true;";
                                                                //lst.Focus.Fn = "Focus1_Change";
                                                            })


                                                            , HQ.NumberField().ID("txtShelfLife").Name("txtShelfLife").HQLangCode("ShelfLife").DataIndex("ShelfLife").MarginSpec("5 0 0 11")
                                                            .Width(400).DecimalPrecision(0).MinValue(0)

                                                             , HQ.NumberField().ID("txtWarrantyDays").Name("txtWarrantyDays").HQLangCode("WarrantyDays").DataIndex("WarrantyDays").MarginSpec("5 0 0 11")
                                                            .Width(400).DecimalPrecision(0).MinValue(0)


                                                            //, HQ.Label().ID("lblPrefix").HQLangCode("Prefix").MarginSpec("30 0 0 0")

                                                        ,X.FieldSet().Title(Util.GetLang("Prefix")).Layout(LayoutType.VBox).MarginSpec("0 0 0 0")
                                                            .Items(
                                                                HQ.Combo().ID("cboLotSerFxdTyp").Name("cboLotSerFxdTyp").HQLangCode("Type").HQProcedure("IN20500_pcLotSerType")
                                                        .HQColumnShow("Code,Descr").DisplayField("Descr").ValueField("Code").DataIndex("LotSerFxdTyp")
                                                        .Width(400).HQHeightWidth(400, 300)
                                                        .HQDBSys(false).HQAutoLoad(true).ForceSelection(true)
                                                        .Triggers(new FieldTrigger() { Icon = TriggerIcon.Clear, HideTrigger = false })
                                                        .HQParam(new StoreParameterCollection() 
                                                        { 
                                                            new StoreParameter() { Name = "@LangID", Value = "HQ.langID", Mode = ParameterMode.Raw }
                                                        })
                                                        .LoadData()
                                                        .Listeners(lst =>
                                                        {
                                                            lst.TriggerClick.Handler = "if (index == 0) { this.clearValue();}";
                                                            //lst.Focus.Handler = "this.forceSelection = true;";
                                                            //lst.Focus.Fn = "Focus1_Change";
                                                            lst.Change.Fn = "cboLotSerFxdTyp_Change";
                                                        })



                                                           , HQ.NumberField().ID("txtLotSerFxdLen").Name("txtLotSerFxdLen").HQLangCode("Length").DataIndex("LotSerFxdLen")
                                                            .Width(400).DecimalPrecision(0).MinValue(0)


                                                           , HQ.TextBox().ID("txtLotSerFxdVal").Name("txtLotSerFxdVal").HQLangCode("Value").DataIndex("LotSerFxdVal")
                                                             .Width(400).MaxLength(12).EnforceMaxLength(true)
                                                             .Listeners(lst =>
                                                            {

                                                                lst.Blur.Fn = "PrefixValue_Change";
                                                                //lst.Focus.Fn = "Focus1_Change";
                                                            })
                                                            )
                                                        


                                                            // , HQ.Label().ID("lblNumberic").HQLangCode("Numeric").MarginSpec("30 0 0 0")

                                                               ,X.FieldSet().Title(Util.GetLang("Numeric")).Layout(LayoutType.VBox).MarginSpec("0 0 0 0")
                                                            .Items(
                                                              HQ.NumberField().ID("txtLotSerNumLen").Name("txtLotSerNumLen").HQLangCode("Length").DataIndex("LotSerNumLen")
                                                            .Width(400).DecimalPrecision(0).MinValue(0)//.AllowBlank(false)


                                                           , HQ.TextBox().ID("txtLotSerNumVal").Name("txtLotSerNumVal").HQLangCode("Value").DataIndex("LotSerNumVal")
                                                             .Width(400).MaxLength(25).EnforceMaxLength(true)
                                                             .Listeners(lst =>
                                                            {
                                                                lst.Blur.Fn = "LastFixValue_Change";
                                                            })

                                                            )
                                                            , HQ.Label().ID("lblNextLotSerial").HQLangCode("NextLotSer").MarginSpec("30 0 0 0")
                                                       

                                                            , HQ.Label().ID("lblShowNextLotSerial").Hidden(true).MarginSpec("0 0 0 50")
                                                           .Listeners(lst =>
                                                            {
                                                                lst.AfterRender.Fn = "NextShowNextLotSerial_AfterRender";
                                                            })
        // ngoac ket thuc tab 3             
                                                )
                                                , X.Panel()
                                                .ID("tabCompany")
                                                .Layout(LayoutType.Anchor)
                                                 
                                                .Border(false)
                                                .Title(Util.GetLang("CpnyID"))
                                                .CloseAction(CloseAction.Hide)
                                                .Listeners(l =>
                                                    {
                                                        l.Render.Handler = "HQ.common.control_render(this,'grd')";
                                                        l.Focus.Handler = "HQ.focus='grd';";
                                                    })                                              
       //.Disabled(true)
                                                .Items(

                                                    Html.X().GridPanel()//.Height(400)
                                                    .RenderTo("contentCenter").Border(true)
                                                    .AutoScroll(true).Layout(LayoutType.Fit)                                                    
                                                    .Anchor("100% -0")// WIDTH HEIGHT  
                                                    .View(X.GridView().TrackOver(false))
                                                    .ID("grd").SetAutoScroll(true)
                                                    .StoreID("stoCompany")
        //.Hidden(true)
                                                    .SortableColumns(false)
                                                        .Listeners(l =>
                                                                {
                                                                    l.Render.Handler = "HQ.common.control_render(this,'grd');";                                                               
                                                                })
       
                                                    .ColumnModel(
                                                        Html.X().RowNumbererColumn()

                                                             , Html.X().Column().Text(Util.GetLang("CpnyID")).Width(100).DataIndex("CpnyID")
                                                            .Editor(
                                                              HQ.Combo().ID("cboCpnyID").Name("cboCpnyID").HQProcedure("IN20500_pcClassCpnyID")
                                                              .HQColumnShow("CpnyID,CpnyName").DisplayField("CpnyID").ValueField("CpnyID")
                                                              .HQHeightWidth(500, 400).ForceSelection(true)
                                                               .HQDBSys(false)
                                                              

                                                             .LoadData()
                                                          )

                                                          , Html.X().Column().Text(Util.GetLang("CpnyName")).DataIndex("CpnyName").Width(250).ID("cboCpnyName")


                                                  , Html.X().CommandColumn().Width(150)
                                                        .Commands(
                                                            Html.X().GridCommand()
                                                                .Text(Util.GetLang("Reject"))
                                                                .ToolTip(t =>
                                                                {
                                                                    t.Text = Util.GetLang("Rejectrowchanges");
                                                                })
                                                                .CommandName("reject")
                                                                .Icon(Icon.ArrowUndo)
                                                        )


                                                    .PrepareToolbar(t =>
                                                    {
                                                        t.Handler = "toolbar.items.get(0).setVisible(record.dirty);";
                                                    })
                                                    .Listeners(l =>
                                                    {
                                                        l.Command.Handler = "grd_Reject(record);";
                                                    })


                                                    )

                                                 .SelectionModel(Html.X().RowSelectionModel().ID("slmGrid").Mode(SelectionMode.Multi))

                                                    .Plugins(
                                                        Html.X()//Cho phep edit )
                                                            .CellEditing()
                                                            .ClicksToEdit(1)
                                                            .Listeners(ls =>
                                                            {
                                                                ls.BeforeEdit.Fn = "grd_BeforeEdit";
                                                                ls.Edit.Fn = "grd_Edit";
                                                                ls.ValidateEdit.Fn = "grd_ValidateEdit";
                                                                //ls.CancelEdit.Fn = "grd_CancelEdit";

                                                            })
                                                    )



                                                
        //ngoac panel chinh cua tat ca tab        
                                        )
                                )                                                                                                                                                         
              //ngoac ket thuc panel ben phai           
                  )                                                                                                                                                
            )                                    

        )
)


