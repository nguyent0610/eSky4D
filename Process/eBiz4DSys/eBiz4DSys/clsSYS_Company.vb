'-- ------------------------------------------------------------
'-- Class name    :  clsSYS_Company
'-- Created date  :  12/11/2012
'-- Created by    :  
'-- Updated by    :  
'-- Generated by    :  Class Maker v1.0
'-- ------------------------------------------------------------

'-- Import Libraries --
Imports HQFramework
Imports HQFramework.DAL
Imports HQFramework.Common

Public Class clsSYS_Company
#Region "Constants"
    Private Const PP_SYS_Company As String = "PP_SYS_Company"
#End Region

#Region "Member Variables"
    Private mvarCpnyID As System.String

    Private mvarCpnyName As System.String

    Private mvarAddress As System.String

    Private mvarTel As System.String

    Private mvarFax As System.String

    Private mvarTaxRegNbr As System.String

    Private mvarChannel As System.String

    Private mvarTerritory As System.String

    Private mvarCountry As System.String

    Private mvarCity As System.String

    Private mvarDistrict As System.String

    Private mvarCpnyType As System.String

    Private mvarEmail As System.String

    Private mvarOwner As System.String

    Private mvarDatabaseName As System.String

    Private mvarCrtd_DateTime As System.DateTime

    Private mvarCrtd_Prog As System.String

    Private mvarCrtd_User As System.String

    Private mvarLUpd_DateTime As System.DateTime

    Private mvarLUpd_Prog As System.String

    Private mvarLUpd_User As System.String

    Private mvartstamp As System.String

    Private mvarPlant As System.String

    Private mvarAddress1 As System.String

    Private mvarAddress2 As System.String

#End Region

    Private m_Dal As DataAccess
#Region "Constructors"
    Public Sub New()
        m_Dal = New DataAccess
        Reset()
    End Sub
    Public Sub New(ByVal dal As DataAccess)
        m_Dal = dal
        Reset()
    End Sub
#End Region

#Region "Public Properties"
    Public Property CpnyID() As System.String
        Get
            Return mvarCpnyID
        End Get
        Set(ByVal Value As System.String)
            mvarCpnyID = Value
        End Set
    End Property

    Public Property CpnyName() As System.String
        Get
            Return mvarCpnyName
        End Get
        Set(ByVal Value As System.String)
            mvarCpnyName = Value
        End Set
    End Property

    Public Property Address() As System.String
        Get
            Return mvarAddress
        End Get
        Set(ByVal Value As System.String)
            mvarAddress = Value
        End Set
    End Property

    Public Property Tel() As System.String
        Get
            Return mvarTel
        End Get
        Set(ByVal Value As System.String)
            mvarTel = Value
        End Set
    End Property

    Public Property Fax() As System.String
        Get
            Return mvarFax
        End Get
        Set(ByVal Value As System.String)
            mvarFax = Value
        End Set
    End Property

    Public Property TaxRegNbr() As System.String
        Get
            Return mvarTaxRegNbr
        End Get
        Set(ByVal Value As System.String)
            mvarTaxRegNbr = Value
        End Set
    End Property

    Public Property Channel() As System.String
        Get
            Return mvarChannel
        End Get
        Set(ByVal Value As System.String)
            mvarChannel = Value
        End Set
    End Property

    Public Property Territory() As System.String
        Get
            Return mvarTerritory
        End Get
        Set(ByVal Value As System.String)
            mvarTerritory = Value
        End Set
    End Property

    Public Property Country() As System.String
        Get
            Return mvarCountry
        End Get
        Set(ByVal Value As System.String)
            mvarCountry = Value
        End Set
    End Property

    Public Property City() As System.String
        Get
            Return mvarCity
        End Get
        Set(ByVal Value As System.String)
            mvarCity = Value
        End Set
    End Property

    Public Property District() As System.String
        Get
            Return mvarDistrict
        End Get
        Set(ByVal Value As System.String)
            mvarDistrict = Value
        End Set
    End Property

    Public Property CpnyType() As System.String
        Get
            Return mvarCpnyType
        End Get
        Set(ByVal Value As System.String)
            mvarCpnyType = Value
        End Set
    End Property

    Public Property Email() As System.String
        Get
            Return mvarEmail
        End Get
        Set(ByVal Value As System.String)
            mvarEmail = Value
        End Set
    End Property

    Public Property Owner() As System.String
        Get
            Return mvarOwner
        End Get
        Set(ByVal Value As System.String)
            mvarOwner = Value
        End Set
    End Property

    Public Property DatabaseName() As System.String
        Get
            Return mvarDatabaseName
        End Get
        Set(ByVal Value As System.String)
            mvarDatabaseName = Value
        End Set
    End Property

    Public Property Crtd_DateTime() As System.DateTime
        Get
            Return mvarCrtd_DateTime
        End Get
        Set(ByVal Value As System.DateTime)
            mvarCrtd_DateTime = Value
        End Set
    End Property

    Public Property Crtd_Prog() As System.String
        Get
            Return mvarCrtd_Prog
        End Get
        Set(ByVal Value As System.String)
            mvarCrtd_Prog = Value
        End Set
    End Property

    Public Property Crtd_User() As System.String
        Get
            Return mvarCrtd_User
        End Get
        Set(ByVal Value As System.String)
            mvarCrtd_User = Value
        End Set
    End Property

    Public Property LUpd_DateTime() As System.DateTime
        Get
            Return mvarLUpd_DateTime
        End Get
        Set(ByVal Value As System.DateTime)
            mvarLUpd_DateTime = Value
        End Set
    End Property

    Public Property LUpd_Prog() As System.String
        Get
            Return mvarLUpd_Prog
        End Get
        Set(ByVal Value As System.String)
            mvarLUpd_Prog = Value
        End Set
    End Property

    Public Property LUpd_User() As System.String
        Get
            Return mvarLUpd_User
        End Get
        Set(ByVal Value As System.String)
            mvarLUpd_User = Value
        End Set
    End Property

    Public Property tstamp() As System.String
        Get
            Return mvartstamp
        End Get
        Set(ByVal Value As System.String)
            mvartstamp = Value
        End Set
    End Property

    Public Property Plant() As System.String
        Get
            Return mvarPlant
        End Get
        Set(ByVal Value As System.String)
            mvarPlant = Value
        End Set
    End Property

    Public Property Address1() As System.String
        Get
            Return mvarAddress1
        End Get
        Set(ByVal Value As System.String)
            mvarAddress1 = Value
        End Set
    End Property

    Public Property Address2() As System.String
        Get
            Return mvarAddress2
        End Get
        Set(ByVal Value As System.String)
            mvarAddress2 = Value
        End Set
    End Property

#End Region

#Region "Public Methods"
    Public Function Add() As Boolean
        Dim DAL As DataAccess = m_Dal
        Try
            Dim pc As New ParamCollection
            pc.Add(New ParamStruct("@Action", DbType.String, "AddNew", ParameterDirection.Input, 50))
            pc.Add(New ParamStruct("@CpnyID", DbType.String, clsCommon.GetValueDBNull(Me.mvarCpnyID), ParameterDirection.Input, 10))
            pc.Add(New ParamStruct("@CpnyName", DbType.String, clsCommon.GetValueDBNull(Me.mvarCpnyName), ParameterDirection.Input, 200))
            pc.Add(New ParamStruct("@Address", DbType.String, clsCommon.GetValueDBNull(Me.mvarAddress), ParameterDirection.Input, 200))
            pc.Add(New ParamStruct("@Tel", DbType.String, clsCommon.GetValueDBNull(Me.mvarTel), ParameterDirection.Input, 20))
            pc.Add(New ParamStruct("@Fax", DbType.String, clsCommon.GetValueDBNull(Me.mvarFax), ParameterDirection.Input, 20))
            pc.Add(New ParamStruct("@TaxRegNbr", DbType.String, clsCommon.GetValueDBNull(Me.mvarTaxRegNbr), ParameterDirection.Input, 20))
            pc.Add(New ParamStruct("@Channel", DbType.String, clsCommon.GetValueDBNull(Me.mvarChannel), ParameterDirection.Input, 10))
            pc.Add(New ParamStruct("@Territory", DbType.String, clsCommon.GetValueDBNull(Me.mvarTerritory), ParameterDirection.Input, 10))
            pc.Add(New ParamStruct("@Country", DbType.String, clsCommon.GetValueDBNull(Me.mvarCountry), ParameterDirection.Input, 3))
            pc.Add(New ParamStruct("@City", DbType.String, clsCommon.GetValueDBNull(Me.mvarCity), ParameterDirection.Input, 10))
            pc.Add(New ParamStruct("@District", DbType.String, clsCommon.GetValueDBNull(Me.mvarDistrict), ParameterDirection.Input, 10))
            pc.Add(New ParamStruct("@CpnyType", DbType.String, clsCommon.GetValueDBNull(Me.mvarCpnyType), ParameterDirection.Input, 15))
            pc.Add(New ParamStruct("@Email", DbType.String, clsCommon.GetValueDBNull(Me.mvarEmail), ParameterDirection.Input, 100))
            pc.Add(New ParamStruct("@Owner", DbType.String, clsCommon.GetValueDBNull(Me.mvarOwner), ParameterDirection.Input, 100))
            pc.Add(New ParamStruct("@DatabaseName", DbType.String, clsCommon.GetValueDBNull(Me.mvarDatabaseName), ParameterDirection.Input, 50))
            pc.Add(New ParamStruct("@Crtd_DateTime", DbType.DateTime, clsCommon.GetValueDBNull(Me.mvarCrtd_DateTime), ParameterDirection.Input, 16))
            pc.Add(New ParamStruct("@Crtd_Prog", DbType.String, clsCommon.GetValueDBNull(Me.mvarCrtd_Prog), ParameterDirection.Input, 8))
            pc.Add(New ParamStruct("@Crtd_User", DbType.String, clsCommon.GetValueDBNull(Me.mvarCrtd_User), ParameterDirection.Input, 10))
            pc.Add(New ParamStruct("@LUpd_DateTime", DbType.DateTime, clsCommon.GetValueDBNull(Me.mvarLUpd_DateTime), ParameterDirection.Input, 16))
            pc.Add(New ParamStruct("@LUpd_Prog", DbType.String, clsCommon.GetValueDBNull(Me.mvarLUpd_Prog), ParameterDirection.Input, 8))
            pc.Add(New ParamStruct("@LUpd_User", DbType.String, clsCommon.GetValueDBNull(Me.mvarLUpd_User), ParameterDirection.Input, 10))
            pc.Add(New ParamStruct("@tstamp", DbType.String, clsCommon.GetValueDBNull(Me.mvartstamp), ParameterDirection.Input, 18))
            pc.Add(New ParamStruct("@Plant", DbType.String, clsCommon.GetValueDBNull(Me.mvarPlant), ParameterDirection.Input, 4))
            pc.Add(New ParamStruct("@Address1", DbType.String, clsCommon.GetValueDBNull(Me.mvarAddress1), ParameterDirection.Input, 400))
            pc.Add(New ParamStruct("@Address2", DbType.String, clsCommon.GetValueDBNull(Me.mvarAddress2), ParameterDirection.Input, 400))
            DAL.ExecPreparedSQL(PP_SYS_Company, CommandType.StoredProcedure, pc, "")
            Me.mvarCpnyID = clsCommon.GetValue(pc.Item("@CpnyID").Value, mvarCpnyID.GetType().FullName)
            Return (Me.mvarCpnyID <> String.Empty)
        Catch ex As Exception
            Throw ex
        End Try
    End Function
    Public Function Update() As Boolean
        Dim DAL As DataAccess = m_Dal
        Try
            Dim pc As New ParamCollection
            pc.Add(New ParamStruct("@Action", DbType.String, "Update", ParameterDirection.Input, 50))
            pc.Add(New ParamStruct("@CpnyID", DbType.String, clsCommon.GetValueDBNull(Me.mvarCpnyID), ParameterDirection.Input, 10))
            pc.Add(New ParamStruct("@CpnyName", DbType.String, clsCommon.GetValueDBNull(Me.mvarCpnyName), ParameterDirection.Input, 200))
            pc.Add(New ParamStruct("@Address", DbType.String, clsCommon.GetValueDBNull(Me.mvarAddress), ParameterDirection.Input, 200))
            pc.Add(New ParamStruct("@Tel", DbType.String, clsCommon.GetValueDBNull(Me.mvarTel), ParameterDirection.Input, 20))
            pc.Add(New ParamStruct("@Fax", DbType.String, clsCommon.GetValueDBNull(Me.mvarFax), ParameterDirection.Input, 20))
            pc.Add(New ParamStruct("@TaxRegNbr", DbType.String, clsCommon.GetValueDBNull(Me.mvarTaxRegNbr), ParameterDirection.Input, 20))
            pc.Add(New ParamStruct("@Channel", DbType.String, clsCommon.GetValueDBNull(Me.mvarChannel), ParameterDirection.Input, 10))
            pc.Add(New ParamStruct("@Territory", DbType.String, clsCommon.GetValueDBNull(Me.mvarTerritory), ParameterDirection.Input, 10))
            pc.Add(New ParamStruct("@Country", DbType.String, clsCommon.GetValueDBNull(Me.mvarCountry), ParameterDirection.Input, 3))
            pc.Add(New ParamStruct("@City", DbType.String, clsCommon.GetValueDBNull(Me.mvarCity), ParameterDirection.Input, 10))
            pc.Add(New ParamStruct("@District", DbType.String, clsCommon.GetValueDBNull(Me.mvarDistrict), ParameterDirection.Input, 10))
            pc.Add(New ParamStruct("@CpnyType", DbType.String, clsCommon.GetValueDBNull(Me.mvarCpnyType), ParameterDirection.Input, 15))
            pc.Add(New ParamStruct("@Email", DbType.String, clsCommon.GetValueDBNull(Me.mvarEmail), ParameterDirection.Input, 100))
            pc.Add(New ParamStruct("@Owner", DbType.String, clsCommon.GetValueDBNull(Me.mvarOwner), ParameterDirection.Input, 100))
            pc.Add(New ParamStruct("@DatabaseName", DbType.String, clsCommon.GetValueDBNull(Me.mvarDatabaseName), ParameterDirection.Input, 50))
            pc.Add(New ParamStruct("@Crtd_DateTime", DbType.DateTime, clsCommon.GetValueDBNull(Me.mvarCrtd_DateTime), ParameterDirection.Input, 16))
            pc.Add(New ParamStruct("@Crtd_Prog", DbType.String, clsCommon.GetValueDBNull(Me.mvarCrtd_Prog), ParameterDirection.Input, 8))
            pc.Add(New ParamStruct("@Crtd_User", DbType.String, clsCommon.GetValueDBNull(Me.mvarCrtd_User), ParameterDirection.Input, 10))
            pc.Add(New ParamStruct("@LUpd_DateTime", DbType.DateTime, clsCommon.GetValueDBNull(Me.mvarLUpd_DateTime), ParameterDirection.Input, 16))
            pc.Add(New ParamStruct("@LUpd_Prog", DbType.String, clsCommon.GetValueDBNull(Me.mvarLUpd_Prog), ParameterDirection.Input, 8))
            pc.Add(New ParamStruct("@LUpd_User", DbType.String, clsCommon.GetValueDBNull(Me.mvarLUpd_User), ParameterDirection.Input, 10))
            pc.Add(New ParamStruct("@tstamp", DbType.String, clsCommon.GetValueDBNull(Me.mvartstamp), ParameterDirection.Input, 18))
            pc.Add(New ParamStruct("@Plant", DbType.String, clsCommon.GetValueDBNull(Me.mvarPlant), ParameterDirection.Input, 4))
            pc.Add(New ParamStruct("@Address1", DbType.String, clsCommon.GetValueDBNull(Me.mvarAddress1), ParameterDirection.Input, 400))
            pc.Add(New ParamStruct("@Address2", DbType.String, clsCommon.GetValueDBNull(Me.mvarAddress2), ParameterDirection.Input, 400))
            Return (DAL.ExecNonQuery(PP_SYS_Company, CommandType.StoredProcedure, pc, "") > 0)
        Catch ex As Exception
            Throw ex
        End Try
    End Function
    Public Function Delete(ByVal CpnyID As System.String) As Boolean
        Dim DAL As DataAccess = m_Dal
        Try
            Dim pc As New ParamCollection
            pc.Add(New ParamStruct("@Action", DbType.String, "Delete", ParameterDirection.Input, 50))
            pc.Add(New ParamStruct("@CpnyID", DbType.String, clsCommon.GetValueDBNull(CpnyID), ParameterDirection.Input, 10))
            Return (DAL.ExecNonQuery(PP_SYS_Company, CommandType.StoredProcedure, pc, "") > 0)
        Catch ex As Exception
            Throw ex
        End Try
    End Function
    Public Function GetAll(ByVal CpnyID As System.String) As DataTable
        Dim DAL As DataAccess = m_Dal
        Try
            Dim pc As New ParamCollection
            Dim ds As New DataSet
            pc.Add(New ParamStruct("@Action", DbType.String, "GetListData", ParameterDirection.Input, 50))
            pc.Add(New ParamStruct("@CpnyID", DbType.String, clsCommon.GetValueDBNull(CpnyID), ParameterDirection.Input, 10))
            ds = DAL.ExecDataSet(PP_SYS_Company, CommandType.StoredProcedure, pc, "")
            Dim keys(0) As DataColumn
            Dim column As DataColumn
            column = ds.Tables(0).Columns("CpnyID")
            keys(0) = column
            ds.Tables(0).PrimaryKey = keys
            Return ds.Tables(0)
        Catch ex As Exception
            Throw ex
        End Try
    End Function
    Public Sub Reset()
        mvarCpnyID = String.Empty
        mvarCpnyName = String.Empty
        mvarAddress = String.Empty
        mvarTel = String.Empty
        mvarFax = String.Empty
        mvarTaxRegNbr = String.Empty
        mvarChannel = String.Empty
        mvarTerritory = String.Empty
        mvarCountry = String.Empty
        mvarCity = String.Empty
        mvarDistrict = String.Empty
        mvarCpnyType = String.Empty
        mvarEmail = String.Empty
        mvarOwner = String.Empty
        mvarDatabaseName = String.Empty
        mvarCrtd_DateTime = Today
        mvarCrtd_Prog = String.Empty
        mvarCrtd_User = String.Empty
        mvarLUpd_DateTime = Today
        mvarLUpd_Prog = String.Empty
        mvarLUpd_User = String.Empty
        mvartstamp = String.Empty
        mvarPlant = String.Empty
        mvarAddress1 = String.Empty
        mvarAddress2 = String.Empty
    End Sub
    Public Function GetByKey(ByVal CpnyID As System.String) As Boolean
        Dim DAL As DataAccess = m_Dal
        Dim ds As New DataSet
        Try
            Dim pc As New ParamCollection
            pc.Add(New ParamStruct("@Action", DbType.String, "GetData_ByKey", ParameterDirection.Input, 50))
            pc.Add(New ParamStruct("@CpnyID", DbType.String, clsCommon.GetValueDBNull(CpnyID), ParameterDirection.InputOutput, 10))
            ds = DAL.ExecDataSet(PP_SYS_Company, CommandType.StoredProcedure, pc, "")
            Me.Reset()
            If ds Is Nothing Then
                Return False
            End If
            If ds.Tables(0).Rows.Count > 0 Then
                FillData(ds.Tables(0).Rows(0))
                Return True
            End If
        Catch ex As Exception
            Throw ex
        End Try
        Return False
    End Function
    Public Sub FillData(row As DataRow)
        mvarCpnyID = clsCommon.GetValue(row("CpnyID"), mvarCpnyID.GetType().FullName)
        mvarCpnyName = clsCommon.GetValue(row("CpnyName"), mvarCpnyName.GetType().FullName)
        mvarAddress = clsCommon.GetValue(row("Address"), mvarAddress.GetType().FullName)
        mvarTel = clsCommon.GetValue(row("Tel"), mvarTel.GetType().FullName)
        mvarFax = clsCommon.GetValue(row("Fax"), mvarFax.GetType().FullName)
        mvarTaxRegNbr = clsCommon.GetValue(row("TaxRegNbr"), mvarTaxRegNbr.GetType().FullName)
        mvarChannel = clsCommon.GetValue(row("Channel"), mvarChannel.GetType().FullName)
        mvarTerritory = clsCommon.GetValue(row("Territory"), mvarTerritory.GetType().FullName)
        mvarCountry = clsCommon.GetValue(row("Country"), mvarCountry.GetType().FullName)
        mvarCity = clsCommon.GetValue(row("City"), mvarCity.GetType().FullName)
        mvarDistrict = clsCommon.GetValue(row("District"), mvarDistrict.GetType().FullName)
        mvarCpnyType = clsCommon.GetValue(row("CpnyType"), mvarCpnyType.GetType().FullName)
        mvarEmail = clsCommon.GetValue(row("Email"), mvarEmail.GetType().FullName)
        mvarOwner = clsCommon.GetValue(row("Owner"), mvarOwner.GetType().FullName)
        mvarDatabaseName = clsCommon.GetValue(row("DatabaseName"), mvarDatabaseName.GetType().FullName)
        mvarCrtd_DateTime = clsCommon.GetValue(row("Crtd_DateTime"), mvarCrtd_DateTime.GetType().FullName)
        mvarCrtd_Prog = clsCommon.GetValue(row("Crtd_Prog"), mvarCrtd_Prog.GetType().FullName)
        mvarCrtd_User = clsCommon.GetValue(row("Crtd_User"), mvarCrtd_User.GetType().FullName)
        mvarLUpd_DateTime = clsCommon.GetValue(row("LUpd_DateTime"), mvarLUpd_DateTime.GetType().FullName)
        mvarLUpd_Prog = clsCommon.GetValue(row("LUpd_Prog"), mvarLUpd_Prog.GetType().FullName)
        mvarLUpd_User = clsCommon.GetValue(row("LUpd_User"), mvarLUpd_User.GetType().FullName)
        mvartstamp = clsCommon.GetValue(row("tstamp"), mvartstamp.GetType().FullName)
        mvarPlant = clsCommon.GetValue(row("Plant"), mvarPlant.GetType().FullName)
        mvarAddress1 = clsCommon.GetValue(row("Address1"), mvarAddress1.GetType().FullName)
        mvarAddress2 = clsCommon.GetValue(row("Address2"), mvarAddress2.GetType().FullName)
    End Sub
#End Region

#Region "Private Methods"
#End Region

End Class
