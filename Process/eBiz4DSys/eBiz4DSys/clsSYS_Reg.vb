'-- ------------------------------------------------------------
'-- Class name    :  clsSYS_Reg
'-- Created date  :  12/11/2012
'-- Created by    :  
'-- Updated by    :  
'-- Generated by    :  Class Maker v1.0
'-- ------------------------------------------------------------

'-- Import Libraries --
Imports HQFramework
Imports HQFramework.DAL
Imports HQFramework.Common

Public Class clsSYS_Reg
#Region "Constants"
    Private Const PP_SYS_Reg As String = "PP_SYS_Reg"
#End Region

#Region "Member Variables"
    Private mvarCustomerID As System.String

    Private mvarAddressLine1 As System.String

    Private mvarAddressLine2 As System.String

    Private mvarUsers As System.Int16

    Private mvarBusinessType As System.String

    Private mvarCity As System.String

    Private mvarCountry As System.String

    Private mvarCustName As System.String

    Private mvarFax As System.String

    Private mvarPhone As System.String

    Private mvarState As System.String

    Private mvarUnlockKey As System.String

    Private mvartstamp As System.String

#End Region

    Private m_Dal As DataAccess
#Region "Constructors"
    Public Sub New()
        m_Dal = New DataAccess
        Reset()
    End Sub
    Public Sub New(ByVal dal As DataAccess)
        m_Dal = dal
        Reset()
    End Sub
#End Region

#Region "Public Properties"
    Public Property CustomerID() As System.String
        Get
            Return mvarCustomerID
        End Get
        Set(ByVal Value As System.String)
            mvarCustomerID = Value
        End Set
    End Property

    Public Property AddressLine1() As System.String
        Get
            Return mvarAddressLine1
        End Get
        Set(ByVal Value As System.String)
            mvarAddressLine1 = Value
        End Set
    End Property

    Public Property AddressLine2() As System.String
        Get
            Return mvarAddressLine2
        End Get
        Set(ByVal Value As System.String)
            mvarAddressLine2 = Value
        End Set
    End Property

    Public Property Users() As System.Int16
        Get
            Return mvarUsers
        End Get
        Set(ByVal Value As System.Int16)
            mvarUsers = Value
        End Set
    End Property

    Public Property BusinessType() As System.String
        Get
            Return mvarBusinessType
        End Get
        Set(ByVal Value As System.String)
            mvarBusinessType = Value
        End Set
    End Property

    Public Property City() As System.String
        Get
            Return mvarCity
        End Get
        Set(ByVal Value As System.String)
            mvarCity = Value
        End Set
    End Property

    Public Property Country() As System.String
        Get
            Return mvarCountry
        End Get
        Set(ByVal Value As System.String)
            mvarCountry = Value
        End Set
    End Property

    Public Property CustName() As System.String
        Get
            Return mvarCustName
        End Get
        Set(ByVal Value As System.String)
            mvarCustName = Value
        End Set
    End Property

    Public Property Fax() As System.String
        Get
            Return mvarFax
        End Get
        Set(ByVal Value As System.String)
            mvarFax = Value
        End Set
    End Property

    Public Property Phone() As System.String
        Get
            Return mvarPhone
        End Get
        Set(ByVal Value As System.String)
            mvarPhone = Value
        End Set
    End Property

    Public Property State() As System.String
        Get
            Return mvarState
        End Get
        Set(ByVal Value As System.String)
            mvarState = Value
        End Set
    End Property

    Public Property UnlockKey() As System.String
        Get
            Return mvarUnlockKey
        End Get
        Set(ByVal Value As System.String)
            mvarUnlockKey = Value
        End Set
    End Property

    Public Property tstamp() As System.String
        Get
            Return mvartstamp
        End Get
        Set(ByVal Value As System.String)
            mvartstamp = Value
        End Set
    End Property

#End Region

#Region "Public Methods"
    Public Function Add() As Boolean
        Dim DAL As DataAccess = m_Dal
        Try
            Dim pc As New ParamCollection
            pc.Add(New ParamStruct("@Action", DbType.String, "AddNew", ParameterDirection.Input, 50))
            pc.Add(New ParamStruct("@CustomerID", DbType.String, clsCommon.GetValueDBNull(Me.mvarCustomerID), ParameterDirection.Input, 10))
            pc.Add(New ParamStruct("@AddressLine1", DbType.String, clsCommon.GetValueDBNull(Me.mvarAddressLine1), ParameterDirection.Input, 100))
            pc.Add(New ParamStruct("@AddressLine2", DbType.String, clsCommon.GetValueDBNull(Me.mvarAddressLine2), ParameterDirection.Input, 100))
            pc.Add(New ParamStruct("@Users", DbType.Int16, clsCommon.GetValueDBNull(Me.mvarUsers), ParameterDirection.Input, 2))
            pc.Add(New ParamStruct("@BusinessType", DbType.String, clsCommon.GetValueDBNull(Me.mvarBusinessType), ParameterDirection.Input, 100))
            pc.Add(New ParamStruct("@City", DbType.String, clsCommon.GetValueDBNull(Me.mvarCity), ParameterDirection.Input, 100))
            pc.Add(New ParamStruct("@Country", DbType.String, clsCommon.GetValueDBNull(Me.mvarCountry), ParameterDirection.Input, 3))
            pc.Add(New ParamStruct("@CustName", DbType.String, clsCommon.GetValueDBNull(Me.mvarCustName), ParameterDirection.Input, 100))
            pc.Add(New ParamStruct("@Fax", DbType.String, clsCommon.GetValueDBNull(Me.mvarFax), ParameterDirection.Input, 30))
            pc.Add(New ParamStruct("@Phone", DbType.String, clsCommon.GetValueDBNull(Me.mvarPhone), ParameterDirection.Input, 30))
            pc.Add(New ParamStruct("@State", DbType.String, clsCommon.GetValueDBNull(Me.mvarState), ParameterDirection.Input, 3))
            pc.Add(New ParamStruct("@UnlockKey", DbType.String, clsCommon.GetValueDBNull(Me.mvarUnlockKey), ParameterDirection.Input, 2048))
            pc.Add(New ParamStruct("@tstamp", DbType.String, clsCommon.GetValueDBNull(Me.mvartstamp), ParameterDirection.Input, 18))
            DAL.ExecPreparedSQL(PP_SYS_Reg, CommandType.StoredProcedure, pc, "")
            Me.mvarCustomerID = clsCommon.GetValue(pc.Item("@CustomerID").Value, mvarCustomerID.GetType().FullName)
            Return (Me.mvarCustomerID <> String.Empty)
        Catch ex As Exception
            Throw ex
        End Try
    End Function
    Public Function Update() As Boolean
        Dim DAL As DataAccess = m_Dal
        Try
            Dim pc As New ParamCollection
            pc.Add(New ParamStruct("@Action", DbType.String, "Update", ParameterDirection.Input, 50))
            pc.Add(New ParamStruct("@CustomerID", DbType.String, clsCommon.GetValueDBNull(Me.mvarCustomerID), ParameterDirection.Input, 10))
            pc.Add(New ParamStruct("@AddressLine1", DbType.String, clsCommon.GetValueDBNull(Me.mvarAddressLine1), ParameterDirection.Input, 100))
            pc.Add(New ParamStruct("@AddressLine2", DbType.String, clsCommon.GetValueDBNull(Me.mvarAddressLine2), ParameterDirection.Input, 100))
            pc.Add(New ParamStruct("@Users", DbType.Int16, clsCommon.GetValueDBNull(Me.mvarUsers), ParameterDirection.Input, 2))
            pc.Add(New ParamStruct("@BusinessType", DbType.String, clsCommon.GetValueDBNull(Me.mvarBusinessType), ParameterDirection.Input, 100))
            pc.Add(New ParamStruct("@City", DbType.String, clsCommon.GetValueDBNull(Me.mvarCity), ParameterDirection.Input, 100))
            pc.Add(New ParamStruct("@Country", DbType.String, clsCommon.GetValueDBNull(Me.mvarCountry), ParameterDirection.Input, 3))
            pc.Add(New ParamStruct("@CustName", DbType.String, clsCommon.GetValueDBNull(Me.mvarCustName), ParameterDirection.Input, 100))
            pc.Add(New ParamStruct("@Fax", DbType.String, clsCommon.GetValueDBNull(Me.mvarFax), ParameterDirection.Input, 30))
            pc.Add(New ParamStruct("@Phone", DbType.String, clsCommon.GetValueDBNull(Me.mvarPhone), ParameterDirection.Input, 30))
            pc.Add(New ParamStruct("@State", DbType.String, clsCommon.GetValueDBNull(Me.mvarState), ParameterDirection.Input, 3))
            pc.Add(New ParamStruct("@UnlockKey", DbType.String, clsCommon.GetValueDBNull(Me.mvarUnlockKey), ParameterDirection.Input, 2048))
            pc.Add(New ParamStruct("@tstamp", DbType.String, clsCommon.GetValueDBNull(Me.mvartstamp), ParameterDirection.Input, 18))
            Return (DAL.ExecNonQuery(PP_SYS_Reg, CommandType.StoredProcedure, pc, "") > 0)
        Catch ex As Exception
            Throw ex
        End Try
    End Function
    Public Function Delete(ByVal CustomerID As System.String) As Boolean
        Dim DAL As DataAccess = m_Dal
        Try
            Dim pc As New ParamCollection
            pc.Add(New ParamStruct("@Action", DbType.String, "Delete", ParameterDirection.Input, 50))
            pc.Add(New ParamStruct("@CustomerID", DbType.String, clsCommon.GetValueDBNull(CustomerID), ParameterDirection.Input, 10))
            Return (DAL.ExecNonQuery(PP_SYS_Reg, CommandType.StoredProcedure, pc, "") > 0)
        Catch ex As Exception
            Throw ex
        End Try
    End Function
    Public Function GetAll(ByVal CustomerID As System.String) As DataTable
        Dim DAL As DataAccess = m_Dal
        Try
            Dim pc As New ParamCollection
            Dim ds As New DataSet
            pc.Add(New ParamStruct("@Action", DbType.String, "GetListData", ParameterDirection.Input, 50))
            pc.Add(New ParamStruct("@CustomerID", DbType.String, clsCommon.GetValueDBNull(CustomerID), ParameterDirection.Input, 10))
            ds = DAL.ExecDataSet(PP_SYS_Reg, CommandType.StoredProcedure, pc, "")
            Dim keys(0) As DataColumn
            Dim column As DataColumn
            column = ds.Tables(0).Columns("CustomerID")
            keys(0) = column
            ds.Tables(0).PrimaryKey = keys
            Return ds.Tables(0)
        Catch ex As Exception
            Throw ex
        End Try
    End Function
    Public Sub Reset()
        mvarCustomerID = String.Empty
        mvarAddressLine1 = String.Empty
        mvarAddressLine2 = String.Empty
        mvarUsers = 0
        mvarBusinessType = String.Empty
        mvarCity = String.Empty
        mvarCountry = String.Empty
        mvarCustName = String.Empty
        mvarFax = String.Empty
        mvarPhone = String.Empty
        mvarState = String.Empty
        mvarUnlockKey = String.Empty
        mvartstamp = String.Empty
    End Sub
    Public Function GetByKey(ByVal CustomerID As System.String) As Boolean
        Dim DAL As DataAccess = m_Dal
        Dim ds As New DataSet
        Try
            Dim pc As New ParamCollection
            pc.Add(New ParamStruct("@Action", DbType.String, "GetData_ByKey", ParameterDirection.Input, 50))
            pc.Add(New ParamStruct("@CustomerID", DbType.String, clsCommon.GetValueDBNull(CustomerID), ParameterDirection.InputOutput, 10))
            ds = DAL.ExecDataSet(PP_SYS_Reg, CommandType.StoredProcedure, pc, "")
            Me.Reset()
            If ds Is Nothing Then
                Return False
            End If
            If ds.Tables(0).Rows.Count > 0 Then
                FillData(ds.Tables(0).Rows(0))
                Return True
            End If
        Catch ex As Exception
            Throw ex
        End Try
        Return False
    End Function
    Public Sub FillData(row As DataRow)
        mvarCustomerID = clsCommon.GetValue(row("CustomerID"), mvarCustomerID.GetType().FullName)
        mvarAddressLine1 = clsCommon.GetValue(row("AddressLine1"), mvarAddressLine1.GetType().FullName)
        mvarAddressLine2 = clsCommon.GetValue(row("AddressLine2"), mvarAddressLine2.GetType().FullName)
        mvarUsers = clsCommon.GetValue(row("Users"), mvarUsers.GetType().FullName)
        mvarBusinessType = clsCommon.GetValue(row("BusinessType"), mvarBusinessType.GetType().FullName)
        mvarCity = clsCommon.GetValue(row("City"), mvarCity.GetType().FullName)
        mvarCountry = clsCommon.GetValue(row("Country"), mvarCountry.GetType().FullName)
        mvarCustName = clsCommon.GetValue(row("CustName"), mvarCustName.GetType().FullName)
        mvarFax = clsCommon.GetValue(row("Fax"), mvarFax.GetType().FullName)
        mvarPhone = clsCommon.GetValue(row("Phone"), mvarPhone.GetType().FullName)
        mvarState = clsCommon.GetValue(row("State"), mvarState.GetType().FullName)
        mvarUnlockKey = clsCommon.GetValue(row("UnlockKey"), mvarUnlockKey.GetType().FullName)
        mvartstamp = clsCommon.GetValue(row("tstamp"), mvartstamp.GetType().FullName)
    End Sub
#End Region

#Region "Private Methods"
#End Region

End Class
