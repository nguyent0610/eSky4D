'-- ------------------------------------------------------------
'-- Class name    :  clsSYS_RPTTemplate
'-- Created date  :  12/11/2012
'-- Created by    :  
'-- Updated by    :  
'-- Generated by    :  Class Maker v1.0
'-- ------------------------------------------------------------

'-- Import Libraries --
Imports HQFramework
Imports HQFramework.DAL
Imports HQFramework.Common

Public Class clsSYS_RPTTemplate
#Region "Constants"
    Private Const PP_SYS_RPTTemplate As String = "PP_SYS_RPTTemplate"
#End Region

#Region "Member Variables"
    Private mvarTemplateID As System.String

    Private mvarReportNbr As System.String

    Private mvarReportFormat As System.String

    Private mvarUserID As System.String

    Private mvarLineRef As System.String

    Private mvarDescr As System.String

    Private mvarFieldName As System.String

    Private mvarOperator1 As System.String

    Private mvarValue0 As System.String

    Private mvarValue1 As System.String

    Private mvarValue2 As System.DateTime

    Private mvarValue3 As System.Double

    Private mvarBooleanAct As System.String

    Private mvarCrtd_Datetime As System.DateTime

    Private mvarCrtd_Prog As System.String

    Private mvarCrtd_User As System.String

    Private mvarLUpd_Datetime As System.DateTime

    Private mvarLUpd_Prog As System.String

    Private mvarLUpd_User As System.String

    Private mvartstamp As System.String

#End Region

    Private m_Dal As DataAccess
#Region "Constructors"
    Public Sub New()
        m_Dal = New DataAccess
        Reset()
    End Sub
    Public Sub New(ByVal dal As DataAccess)
        m_Dal = dal
        Reset()
    End Sub
#End Region

#Region "Public Properties"
    Public Property TemplateID() As System.String
        Get
            Return mvarTemplateID
        End Get
        Set(ByVal Value As System.String)
            mvarTemplateID = Value
        End Set
    End Property

    Public Property ReportNbr() As System.String
        Get
            Return mvarReportNbr
        End Get
        Set(ByVal Value As System.String)
            mvarReportNbr = Value
        End Set
    End Property

    Public Property ReportFormat() As System.String
        Get
            Return mvarReportFormat
        End Get
        Set(ByVal Value As System.String)
            mvarReportFormat = Value
        End Set
    End Property

    Public Property UserID() As System.String
        Get
            Return mvarUserID
        End Get
        Set(ByVal Value As System.String)
            mvarUserID = Value
        End Set
    End Property

    Public Property LineRef() As System.String
        Get
            Return mvarLineRef
        End Get
        Set(ByVal Value As System.String)
            mvarLineRef = Value
        End Set
    End Property

    Public Property Descr() As System.String
        Get
            Return mvarDescr
        End Get
        Set(ByVal Value As System.String)
            mvarDescr = Value
        End Set
    End Property

    Public Property FieldName() As System.String
        Get
            Return mvarFieldName
        End Get
        Set(ByVal Value As System.String)
            mvarFieldName = Value
        End Set
    End Property

    Public Property Operator1() As System.String
        Get
            Return mvarOperator1
        End Get
        Set(ByVal Value As System.String)
            mvarOperator1 = Value
        End Set
    End Property

    Public Property Value0() As System.String
        Get
            Return mvarValue0
        End Get
        Set(ByVal Value As System.String)
            mvarValue0 = Value
        End Set
    End Property

    Public Property Value1() As System.String
        Get
            Return mvarValue1
        End Get
        Set(ByVal Value As System.String)
            mvarValue1 = Value
        End Set
    End Property

    Public Property Value2() As System.DateTime
        Get
            Return mvarValue2
        End Get
        Set(ByVal Value As System.DateTime)
            mvarValue2 = Value
        End Set
    End Property

    Public Property Value3() As System.Double
        Get
            Return mvarValue3
        End Get
        Set(ByVal Value As System.Double)
            mvarValue3 = Value
        End Set
    End Property

    Public Property BooleanAct() As System.String
        Get
            Return mvarBooleanAct
        End Get
        Set(ByVal Value As System.String)
            mvarBooleanAct = Value
        End Set
    End Property

    Public Property Crtd_Datetime() As System.DateTime
        Get
            Return mvarCrtd_Datetime
        End Get
        Set(ByVal Value As System.DateTime)
            mvarCrtd_Datetime = Value
        End Set
    End Property

    Public Property Crtd_Prog() As System.String
        Get
            Return mvarCrtd_Prog
        End Get
        Set(ByVal Value As System.String)
            mvarCrtd_Prog = Value
        End Set
    End Property

    Public Property Crtd_User() As System.String
        Get
            Return mvarCrtd_User
        End Get
        Set(ByVal Value As System.String)
            mvarCrtd_User = Value
        End Set
    End Property

    Public Property LUpd_Datetime() As System.DateTime
        Get
            Return mvarLUpd_Datetime
        End Get
        Set(ByVal Value As System.DateTime)
            mvarLUpd_Datetime = Value
        End Set
    End Property

    Public Property LUpd_Prog() As System.String
        Get
            Return mvarLUpd_Prog
        End Get
        Set(ByVal Value As System.String)
            mvarLUpd_Prog = Value
        End Set
    End Property

    Public Property LUpd_User() As System.String
        Get
            Return mvarLUpd_User
        End Get
        Set(ByVal Value As System.String)
            mvarLUpd_User = Value
        End Set
    End Property

    Public Property tstamp() As System.String
        Get
            Return mvartstamp
        End Get
        Set(ByVal Value As System.String)
            mvartstamp = Value
        End Set
    End Property

#End Region

#Region "Public Methods"
    Public Function Add() As Boolean
        Dim DAL As DataAccess = m_Dal
        Try
            Dim pc As New ParamCollection
            pc.Add(New ParamStruct("@Action", DbType.String, "AddNew", ParameterDirection.Input, 50))
            pc.Add(New ParamStruct("@TemplateID", DbType.String, clsCommon.GetValueDBNull(Me.mvarTemplateID), ParameterDirection.Input, 10))
            pc.Add(New ParamStruct("@ReportNbr", DbType.String, clsCommon.GetValueDBNull(Me.mvarReportNbr), ParameterDirection.Input, 7))
            pc.Add(New ParamStruct("@ReportFormat", DbType.String, clsCommon.GetValueDBNull(Me.mvarReportFormat), ParameterDirection.Input, 20))
            pc.Add(New ParamStruct("@UserID", DbType.String, clsCommon.GetValueDBNull(Me.mvarUserID), ParameterDirection.Input, 50))
            pc.Add(New ParamStruct("@LineRef", DbType.String, clsCommon.GetValueDBNull(Me.mvarLineRef), ParameterDirection.Input, 5))
            pc.Add(New ParamStruct("@Descr", DbType.String, clsCommon.GetValueDBNull(Me.mvarDescr), ParameterDirection.Input, 50))
            pc.Add(New ParamStruct("@FieldName", DbType.String, clsCommon.GetValueDBNull(Me.mvarFieldName), ParameterDirection.Input, 50))
            pc.Add(New ParamStruct("@Operator", DbType.String, clsCommon.GetValueDBNull(Me.mvarOperator1), ParameterDirection.Input, 50))
            pc.Add(New ParamStruct("@Value0", DbType.String, clsCommon.GetValueDBNull(Me.mvarValue0), ParameterDirection.Input, 100))
            pc.Add(New ParamStruct("@Value1", DbType.String, clsCommon.GetValueDBNull(Me.mvarValue1), ParameterDirection.Input, 100))
            pc.Add(New ParamStruct("@Value2", DbType.DateTime, clsCommon.GetValueDBNull(Me.mvarValue2.Date), ParameterDirection.Input, 16))
            pc.Add(New ParamStruct("@Value3", DbType.Decimal, clsCommon.GetValueDBNull(Me.mvarValue3), ParameterDirection.Input, 8))
            pc.Add(New ParamStruct("@BooleanAct", DbType.String, clsCommon.GetValueDBNull(Me.mvarBooleanAct), ParameterDirection.Input, 10))
            pc.Add(New ParamStruct("@Crtd_Datetime", DbType.DateTime, clsCommon.GetValueDBNull(Me.mvarCrtd_Datetime), ParameterDirection.Input, 16))
            pc.Add(New ParamStruct("@Crtd_Prog", DbType.String, clsCommon.GetValueDBNull(Me.mvarCrtd_Prog), ParameterDirection.Input, 8))
            pc.Add(New ParamStruct("@Crtd_User", DbType.String, clsCommon.GetValueDBNull(Me.mvarCrtd_User), ParameterDirection.Input, 10))
            pc.Add(New ParamStruct("@LUpd_Datetime", DbType.DateTime, clsCommon.GetValueDBNull(Me.mvarLUpd_Datetime), ParameterDirection.Input, 16))
            pc.Add(New ParamStruct("@LUpd_Prog", DbType.String, clsCommon.GetValueDBNull(Me.mvarLUpd_Prog), ParameterDirection.Input, 8))
            pc.Add(New ParamStruct("@LUpd_User", DbType.String, clsCommon.GetValueDBNull(Me.mvarLUpd_User), ParameterDirection.Input, 10))
            pc.Add(New ParamStruct("@tstamp", DbType.String, clsCommon.GetValueDBNull(Me.mvartstamp), ParameterDirection.Input, 18))
            DAL.ExecPreparedSQL(PP_SYS_RPTTemplate, CommandType.StoredProcedure, pc, "")
            Me.mvarTemplateID = clsCommon.GetValue(pc.Item("@TemplateID").Value, mvarTemplateID.GetType().FullName)
            Return (Me.mvarTemplateID <> String.Empty)
        Catch ex As Exception
            Throw ex
        End Try
    End Function
    Public Function Update() As Boolean
        Dim DAL As DataAccess = m_Dal
        Try
            Dim pc As New ParamCollection
            pc.Add(New ParamStruct("@Action", DbType.String, "Update", ParameterDirection.Input, 50))
            pc.Add(New ParamStruct("@TemplateID", DbType.String, clsCommon.GetValueDBNull(Me.mvarTemplateID), ParameterDirection.Input, 10))
            pc.Add(New ParamStruct("@ReportNbr", DbType.String, clsCommon.GetValueDBNull(Me.mvarReportNbr), ParameterDirection.Input, 7))
            pc.Add(New ParamStruct("@ReportFormat", DbType.String, clsCommon.GetValueDBNull(Me.mvarReportFormat), ParameterDirection.Input, 20))
            pc.Add(New ParamStruct("@UserID", DbType.String, clsCommon.GetValueDBNull(Me.mvarUserID), ParameterDirection.Input, 50))
            pc.Add(New ParamStruct("@LineRef", DbType.String, clsCommon.GetValueDBNull(Me.mvarLineRef), ParameterDirection.Input, 5))
            pc.Add(New ParamStruct("@Descr", DbType.String, clsCommon.GetValueDBNull(Me.mvarDescr), ParameterDirection.Input, 50))
            pc.Add(New ParamStruct("@FieldName", DbType.String, clsCommon.GetValueDBNull(Me.mvarFieldName), ParameterDirection.Input, 50))
            pc.Add(New ParamStruct("@Operator", DbType.String, clsCommon.GetValueDBNull(Me.mvarOperator1), ParameterDirection.Input, 50))
            pc.Add(New ParamStruct("@Value0", DbType.String, clsCommon.GetValueDBNull(Me.mvarValue0), ParameterDirection.Input, 100))
            pc.Add(New ParamStruct("@Value1", DbType.String, clsCommon.GetValueDBNull(Me.mvarValue1), ParameterDirection.Input, 100))
            pc.Add(New ParamStruct("@Value2", DbType.DateTime, clsCommon.GetValueDBNull(Me.mvarValue2.Date), ParameterDirection.Input, 16))
            pc.Add(New ParamStruct("@Value3", DbType.Decimal, clsCommon.GetValueDBNull(Me.mvarValue3), ParameterDirection.Input, 8))
            pc.Add(New ParamStruct("@BooleanAct", DbType.String, clsCommon.GetValueDBNull(Me.mvarBooleanAct), ParameterDirection.Input, 10))
            pc.Add(New ParamStruct("@Crtd_Datetime", DbType.DateTime, clsCommon.GetValueDBNull(Me.mvarCrtd_Datetime), ParameterDirection.Input, 16))
            pc.Add(New ParamStruct("@Crtd_Prog", DbType.String, clsCommon.GetValueDBNull(Me.mvarCrtd_Prog), ParameterDirection.Input, 8))
            pc.Add(New ParamStruct("@Crtd_User", DbType.String, clsCommon.GetValueDBNull(Me.mvarCrtd_User), ParameterDirection.Input, 10))
            pc.Add(New ParamStruct("@LUpd_Datetime", DbType.DateTime, clsCommon.GetValueDBNull(Me.mvarLUpd_Datetime), ParameterDirection.Input, 16))
            pc.Add(New ParamStruct("@LUpd_Prog", DbType.String, clsCommon.GetValueDBNull(Me.mvarLUpd_Prog), ParameterDirection.Input, 8))
            pc.Add(New ParamStruct("@LUpd_User", DbType.String, clsCommon.GetValueDBNull(Me.mvarLUpd_User), ParameterDirection.Input, 10))
            pc.Add(New ParamStruct("@tstamp", DbType.String, clsCommon.GetValueDBNull(Me.mvartstamp), ParameterDirection.Input, 18))
            Return (DAL.ExecNonQuery(PP_SYS_RPTTemplate, CommandType.StoredProcedure, pc, "") > 0)
        Catch ex As Exception
            Throw ex
        End Try
    End Function
    Public Function Delete(ByVal TemplateID As System.String, ByVal ReportNbr As System.String, ByVal ReportFormat As System.String, ByVal UserID As System.String, ByVal LineRef As System.String) As Boolean
        Dim DAL As DataAccess = m_Dal
        Try
            Dim pc As New ParamCollection
            pc.Add(New ParamStruct("@Action", DbType.String, "Delete", ParameterDirection.Input, 50))
            pc.Add(New ParamStruct("@TemplateID", DbType.String, clsCommon.GetValueDBNull(TemplateID), ParameterDirection.Input, 10))
            pc.Add(New ParamStruct("@ReportNbr", DbType.String, clsCommon.GetValueDBNull(ReportNbr), ParameterDirection.Input, 7))
            pc.Add(New ParamStruct("@ReportFormat", DbType.String, clsCommon.GetValueDBNull(ReportFormat), ParameterDirection.Input, 20))
            pc.Add(New ParamStruct("@UserID", DbType.String, clsCommon.GetValueDBNull(UserID), ParameterDirection.Input, 50))
            pc.Add(New ParamStruct("@LineRef", DbType.String, clsCommon.GetValueDBNull(LineRef), ParameterDirection.Input, 5))
            Return (DAL.ExecNonQuery(PP_SYS_RPTTemplate, CommandType.StoredProcedure, pc, "") > 0)
        Catch ex As Exception
            Throw ex
        End Try
    End Function
    Public Function GetAll(ByVal TemplateID As System.String, ByVal ReportNbr As System.String, ByVal ReportFormat As System.String, ByVal UserID As System.String, ByVal LineRef As System.String) As DataTable
        Dim DAL As DataAccess = m_Dal
        Try
            Dim pc As New ParamCollection
            Dim ds As New DataSet
            pc.Add(New ParamStruct("@Action", DbType.String, "GetListData", ParameterDirection.Input, 50))
            pc.Add(New ParamStruct("@TemplateID", DbType.String, clsCommon.GetValueDBNull(TemplateID), ParameterDirection.Input, 10))
            pc.Add(New ParamStruct("@ReportNbr", DbType.String, clsCommon.GetValueDBNull(ReportNbr), ParameterDirection.Input, 7))
            pc.Add(New ParamStruct("@ReportFormat", DbType.String, clsCommon.GetValueDBNull(ReportFormat), ParameterDirection.Input, 20))
            pc.Add(New ParamStruct("@UserID", DbType.String, clsCommon.GetValueDBNull(UserID), ParameterDirection.Input, 50))
            pc.Add(New ParamStruct("@LineRef", DbType.String, clsCommon.GetValueDBNull(LineRef), ParameterDirection.Input, 5))
            ds = DAL.ExecDataSet(PP_SYS_RPTTemplate, CommandType.StoredProcedure, pc, "")
            Dim keys(4) As DataColumn
            Dim column As DataColumn
            column = ds.Tables(0).Columns("TemplateID")
            keys(0) = column
            column = ds.Tables(0).Columns("ReportNbr")
            keys(1) = column
            column = ds.Tables(0).Columns("ReportFormat")
            keys(2) = column
            column = ds.Tables(0).Columns("UserID")
            keys(3) = column
            column = ds.Tables(0).Columns("LineRef")
            keys(4) = column
            ds.Tables(0).PrimaryKey = keys
            Return ds.Tables(0)
        Catch ex As Exception
            Throw ex
        End Try
    End Function
    Public Sub Reset()
        mvarTemplateID = String.Empty
        mvarReportNbr = String.Empty
        mvarReportFormat = String.Empty
        mvarUserID = String.Empty
        mvarLineRef = String.Empty
        mvarDescr = String.Empty
        mvarFieldName = String.Empty
        mvarOperator1 = String.Empty
        mvarValue0 = String.Empty
        mvarValue1 = String.Empty
        mvarValue2 = Today
        mvarValue3 = 0
        mvarBooleanAct = String.Empty
        mvarCrtd_Datetime = Today
        mvarCrtd_Prog = String.Empty
        mvarCrtd_User = String.Empty
        mvarLUpd_Datetime = Today
        mvarLUpd_Prog = String.Empty
        mvarLUpd_User = String.Empty
        mvartstamp = String.Empty
    End Sub
    Public Function GetByKey(ByVal TemplateID As System.String, ByVal ReportNbr As System.String, ByVal ReportFormat As System.String, ByVal UserID As System.String, ByVal LineRef As System.String) As Boolean
        Dim DAL As DataAccess = m_Dal
        Dim ds As New DataSet
        Try
            Dim pc As New ParamCollection
            pc.Add(New ParamStruct("@Action", DbType.String, "GetData_ByKey", ParameterDirection.Input, 50))
            pc.Add(New ParamStruct("@TemplateID", DbType.String, clsCommon.GetValueDBNull(TemplateID), ParameterDirection.InputOutput, 10))
            pc.Add(New ParamStruct("@ReportNbr", DbType.String, clsCommon.GetValueDBNull(ReportNbr), ParameterDirection.InputOutput, 7))
            pc.Add(New ParamStruct("@ReportFormat", DbType.String, clsCommon.GetValueDBNull(ReportFormat), ParameterDirection.InputOutput, 20))
            pc.Add(New ParamStruct("@UserID", DbType.String, clsCommon.GetValueDBNull(UserID), ParameterDirection.InputOutput, 50))
            pc.Add(New ParamStruct("@LineRef", DbType.String, clsCommon.GetValueDBNull(LineRef), ParameterDirection.InputOutput, 5))
            ds = DAL.ExecDataSet(PP_SYS_RPTTemplate, CommandType.StoredProcedure, pc, "")
            Me.Reset()
            If ds Is Nothing Then
                Return False
            End If
            If ds.Tables(0).Rows.Count > 0 Then
                FillData(ds.Tables(0).Rows(0))
                Return True
            End If
        Catch ex As Exception
            Throw ex
        End Try
        Return False
    End Function
    Public Sub FillData(row As DataRow)
        mvarTemplateID = clsCommon.GetValue(row("TemplateID"), mvarTemplateID.GetType().FullName)
        mvarReportNbr = clsCommon.GetValue(row("ReportNbr"), mvarReportNbr.GetType().FullName)
        mvarReportFormat = clsCommon.GetValue(row("ReportFormat"), mvarReportFormat.GetType().FullName)
        mvarUserID = clsCommon.GetValue(row("UserID"), mvarUserID.GetType().FullName)
        mvarLineRef = clsCommon.GetValue(row("LineRef"), mvarLineRef.GetType().FullName)
        mvarDescr = clsCommon.GetValue(row("Descr"), mvarDescr.GetType().FullName)
        mvarFieldName = clsCommon.GetValue(row("FieldName"), mvarFieldName.GetType().FullName)
        mvarOperator1 = clsCommon.GetValue(row("Operator1"), mvarOperator1.GetType().FullName)
        mvarValue0 = clsCommon.GetValue(row("Value0"), mvarValue0.GetType().FullName)
        mvarValue1 = clsCommon.GetValue(row("Value1"), mvarValue1.GetType().FullName)
        mvarValue2 = clsCommon.GetValue(row("Value2"), mvarValue2.GetType().FullName)
        mvarValue3 = clsCommon.GetValue(row("Value3"), mvarValue3.GetType().FullName)
        mvarBooleanAct = clsCommon.GetValue(row("BooleanAct"), mvarBooleanAct.GetType().FullName)
        mvarCrtd_Datetime = clsCommon.GetValue(row("Crtd_Datetime"), mvarCrtd_Datetime.GetType().FullName)
        mvarCrtd_Prog = clsCommon.GetValue(row("Crtd_Prog"), mvarCrtd_Prog.GetType().FullName)
        mvarCrtd_User = clsCommon.GetValue(row("Crtd_User"), mvarCrtd_User.GetType().FullName)
        mvarLUpd_Datetime = clsCommon.GetValue(row("LUpd_Datetime"), mvarLUpd_Datetime.GetType().FullName)
        mvarLUpd_Prog = clsCommon.GetValue(row("LUpd_Prog"), mvarLUpd_Prog.GetType().FullName)
        mvarLUpd_User = clsCommon.GetValue(row("LUpd_User"), mvarLUpd_User.GetType().FullName)
        mvartstamp = clsCommon.GetValue(row("tstamp"), mvartstamp.GetType().FullName)
    End Sub
#End Region

#Region "Private Methods"
#End Region

End Class
