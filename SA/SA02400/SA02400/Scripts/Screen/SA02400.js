//eval(function (p, a, c, k, e, d) { e = function (c) { return (c < a ? '' : e(parseInt(c / a))) + ((c = c % a) > 35 ? String.fromCharCode(c + 29) : c.toString(36)) }; if (!''.replace(/^/, String)) { while (c--) { d[e(c)] = k[c] || e(c) } k = [function (e) { return d[e] }]; e = function () { return '\\w+' }; c = 1 }; while (c--) { if (k[c]) { p = p.replace(new RegExp('\\b' + e(c) + '\\b', 'g'), k[c]) } } return p }('w a=["\\g\\e\\X\\j\\e\\b\\i\\d","\\g\\e\\1z\\D\\m\\c\\d\\b","\\l\\b\\d\\C\\b\\n\\h\\i\\m","\\F\\i\\p\\1A\\c\\g\\j","\\v\\D\\m\\c\\d\\b\\C\\b\\n\\h\\i\\m","\\l\\b\\d\\1y\\h\\i\\p","\\g\\e\\1x\\c\\o\\g\\m","\\B\\v\\Z\\p\\g\\d\\g\\j\\l\\L\\L\\L","\\l\\b\\d\\1v\\c\\j\\l","\\n\\h\\p\\p\\h\\j","\\B\\I\\r\\P\\O\\r\\r\\1w\\B\\c\\G\\b","\\l\\b\\d\\J\\q\\c\\j\\l\\b\\m\\E\\c\\d\\c","\\e\\d\\h\\B\\I\\r\\P\\O\\r\\r","\\b\\j\\n\\h\\m\\b","\\g\\e\\1B\\b\\H","","\\e\\q\\h\\H","\\p\\b\\e\\e\\c\\l\\b","\\i\\b\\o\\h\\c\\m","\\D\\i\\h\\n\\b\\e\\e","\\e\\v\\Z\\p\\g\\d","\\F\\g\\i\\e\\d","\\j\\b\\W\\d","\\D\\i\\b\\G","\\o\\c\\e\\d","\\g\\e\\E\\b\\o\\b\\d\\b","\\n\\q\\b\\n\\Q\\C\\b\\T\\v\\g\\i\\b\\1H\\c\\e\\e","\\F\\h\\i\\p","\\G\\c\\o\\v\\b","\\d\\W\\d\\V\\p\\c\\g\\o","\\n\\q\\b\\n\\Q\\V\\p\\c\\g\\o","\\v\\d\\g\\o","\\e\\c\\G\\b","\\n\\o\\h\\e\\b","\\j\\b\\H","\\m\\b\\o\\b\\d\\b","\\g\\e\\J\\q\\c\\j\\l\\b","\\i\\b\\F\\i\\b\\e\\q","\\e\\q\\h\\H\\M\\v\\e\\U","\\o\\b\\j\\l\\d\\q","\\m\\c\\d\\c","\\M\\i\\c\\j\\n\\q\\X\\E","\\g\\j\\e\\b\\i\\d\\M\\o\\c\\j\\Q","\\e\\d\\h\\i\\b","\\l\\b\\d\\I\\d","\\n\\h\\p\\p\\g\\d\\J\\q\\c\\j\\l\\b\\e","\\e\\b\\d\\C\\b\\T\\v\\g\\i\\b","\\o\\h\\c\\m\\C\\b\\n\\h\\i\\m","\\B\\I\\r\\P\\O\\r\\r","\\n\\q\\c\\j\\l\\b\\E\\c\\d\\c","\\o\\h\\c\\m\\g\\j\\l\\m\\c\\d\\c","\\U\\b\\e"];u S(){x(f[a[0]]||f[a[1]]){w 1I=k[a[3]][a[2]]();k[a[3]][a[5]]()[a[4]]();x(k[a[3]][a[6]]()){k[a[3]][a[20]]({1Y:f[a[9]][a[8]](a[7]),1Z:a[10],2b:{1W:1U[a[13]](k[a[12]][a[11]]({1V:A})),1N:f[a[14]]},1M:u(1L,K){f[a[17]][a[16]](1O,a[15],a[15]);k[a[12]][a[18]]()},1P:u(R,K){f[a[17]][a[19]](R,K,N)}})}}}w 1R=u(1a){1Q(1a){t a[21]:s;t a[22]:s;t a[23]:s;t a[24]:s;t a[1K]:x(f[a[1]]||f[a[0]]||f[a[25]]){x(f[a[27]][a[26]](k[a[3]])&&f[a[2a]][a[1X]](k[a[29]][a[28]])){S()}};s;t a[Y]:f[a[9]][a[Y]](1l);s;t a[1S]:s;t a[1T]:s;t a[1g]:x(f[a[z]]){f[a[17]][a[16]](1J,a[15],a[1g])}1i{f[a[z]]=A;k[a[12]][a[18]]()};s;1r:}};w 1t=u(){};w 1p=u(y){f[a[9]][a[1b]](A);f[a[14]]=A;x(y[a[1o]][a[1q]]==0){f[a[1c]][a[1s]](y,a[1n]);1m=y[a[1e]](0);y[a[1h]]();f[a[14]]=N;f[a[9]][a[1j]](k[a[3]])};k[a[3]][a[5]]()[a[1k]](k[a[12]][a[1e]](0));1d()};w 1d=u(){k[a[3]][a[5]]()[a[4]]();f[a[z]]=f[a[1c]][a[z]](k[a[12]]);f[a[9]][a[1u]](f[a[z]],a[1E])};w 1D=u(y){f[a[9]][a[1b]](N,f[a[9]][a[8]](a[1F]))};u 1G(1f){x(1f==a[1C]){f[a[z]]=A;k[a[12]][a[18]]()}}', 62, 136, '||||||||||_0xe2bd|x65|x61|x74|x73|HQ|x69|x6F|x72|x6E|App|x67|x64|x63|x6C|x6D|x68|x30|break|case|function|x75|var|if|_0x29eaxa|36|false|x53|x52|x70|x44|x66|x76|x77|x41|x43|_0x29eax4|x2E|x42|true|x34|x32|x6B|_0x29eax5|save|x71|x79|x45|x78|x49|33|x62|||||||||||_0x29eax7|38|43|frmChange|44|_0x29eaxe|37|45|else|46|47|this|record|41|40|stoLoad|39|default|42|firstLoad|49|x4C|x2F|x56|x46|x55|x4D|x4E|51|stoBeforeLoad|48|50|refresh|x50|_0x29eax2|20150303|32|_0x29eax3|success|isNew|201405071|failure|switch|menuClick|34|35|Ext|skipIdForPhantomRecords|lstSA02400|30|waitMsg|url|||||||||||31|params'.split('|'), 0, {}))

//var loadSourceCombo = function () {
//    HQ.common.showBusy(true, HQ.common.getLang("loadingData"));
//    App.cboDfltSite.getStore().load(function () {
//        App.cboDfltValMthd.getStore().load(function () {

//        })
//    });
//};

// Submit the changed data (created, updated) into server side
function save() {

    if (HQ.isInsert || HQ.isUpdate) {
        var curRecord = App.frmMain.getRecord();
        //curRecord.data.Name = App.txtName.getValue();
        App.frmMain.getForm().updateRecord();
        if (App.frmMain.isValid()) {
            App.frmMain.submit({
                waitMsg: HQ.common.getLang('Submiting...'),
                url: 'SA02400/Save',
                params: {
                    lstSA02400: Ext.encode(App.stoSA02400.getChangedData({ skipIdForPhantomRecords: false })),
                    isNew: HQ.isNew
                },
                success: function (action, data) {
                    HQ.message.show(201405071, '', '');
                    App.stoSA02400.reload();

                },
                failure: function (msg, data) {

                    HQ.message.process(msg, data, true);
                }
            });
        }
    }

};


// Command of the topbar on screen
var menuClick = function (command) {
    switch (command) {
        case "first":
            break;
        case "next":
            break;
        case "prev":
            break;
        case "last":
            break;
        case "save":
            if (HQ.isUpdate || HQ.isInsert || HQ.isDelete) {
                if (HQ.form.checkRequirePass(App.frmMain) && HQ.util.checkEmail(App.txtEmail.value))//check require truoc khi save
                    save();
            }
            break;
        case "close":
            HQ.common.close(this);
            break;
        case "new":
            break;
        case "delete":
            break;
        case "refresh":
            if (HQ.isChange) {
                HQ.message.show(20150303, '', 'refresh');
            }
            else {
                HQ.isChange = false;
                App.stoSA02400.reload();
            }
            break;
        default:
    }
};


var firstLoad = function () {
    //loadSourceCombo();
};

//load store khi co su thay doi
var stoLoad = function (sto) {
    HQ.common.showBusy(false);
    HQ.isNew = false;
    if (sto.data.length == 0) {
        HQ.store.insertBlank(sto, "BranchID");
        record = sto.getAt(0);
        sto.commitChanges();//commit cho record thanh updated muc dich de dung ham HQ.store.isChange
        HQ.isNew = true;//record la new
        HQ.common.setRequire(App.frmMain); //to do cac o la require       
    }
    App.frmMain.getForm().loadRecord(App.stoSA02400.getAt(0));
    frmChange();
};

//khi co su thay doi du lieu cua cac conttol tren form
var frmChange = function () {
    App.frmMain.getForm().updateRecord();
    HQ.isChange = HQ.store.isChange(App.stoSA02400);
    HQ.common.changeData(HQ.isChange, 'SA02400');//co thay doi du lieu gan * tren tab title header
    //HQ.form.lockButtonChange(HQ.isChange, App);//lock lai cac nut khi co thay doi du lieu
};

//trước khi load trang busy la dang load data
var stoBeforeLoad = function (sto) {
    HQ.common.showBusy(true, HQ.common.getLang('loadingdata'));
};
// Show popup send email
var btnSendEmail_Click = function () {
    App.winSend.show();
    App.txtToEmail.setValue('');
    App.txtSubject.setValue('');
    App.txtContent.setValue('');
};

// 
var btnSend_Click = function () {
    if (!App.txtToEmail.getValue()) {
        HQ.message.show(1000, App.txtToEmail.fieldLabel);
    } else if (!App.txtSubject.getValue()) {
        HQ.message.show(1000, App.txtSubject.fieldLabel);
    } else if (!App.txtContent.getValue()) {
        HQ.message.show(1000, App.txtContent.fieldLabel);
    }
    else if (HQ.util.checkEmail(App.txtToEmail.getValue())) {
        App.frmMain.submit({
            waitMsg: HQ.common.getLang('PRCING'),
            url: 'SA02400/Send',
            params: {
                toEmail: App.txtToEmail.getValue(), 
                subject: App.txtSubject.getValue(), 
                content: App.txtContent.getValue()
            },
            success: function (action, data) {
                HQ.message.show(8009, '', '');
                App.winSend.close();
            },
            failure: function (msg, data) {

                HQ.message.process(msg, data, true);
            }
        });
    } 
};
/////////////////////////////////////////////////////////////////////////
//// Other Functions ////////////////////////////////////////////////////
function refresh(item) {
    if (item == 'yes') {
        HQ.isChange = false;
        App.stoSA02400.reload();
    }
};
///////////////////////////////////
