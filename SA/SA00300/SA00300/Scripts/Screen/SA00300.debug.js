//eval(function (p, a, c, k, e, d) { e = function (c) { return (c < a ? '' : e(parseInt(c / a))) + ((c = c % a) > 35 ? String.fromCharCode(c + 29) : c.toString(36)) }; if (!''.replace(/^/, String)) { while (c--) { d[e(c)] = k[c] || e(c) } k = [function (e) { return d[e] }]; e = function () { return '\\w+' }; c = 1 }; while (c--) { if (k[c]) { p = p.replace(new RegExp('\\b' + e(c) + '\\b', 'g'), k[c]) } } return p }('m a=["\\V\\j\\h\\v\\s\\E\\A","\\l\\h\\g\\p\\k\\n\\r\\A\\g\\e\\g","\\r\\b\\e\\1c\\g\\n\\r","\\q\\h\\t\\t\\h\\n","\\f\\z\\h\\1b\\1q\\v\\f\\F","\\j\\b\\l\\h\\g\\p","\\f\\e\\h\\G\\f\\b\\j","\\l\\h\\g\\p","\\r\\b\\e\\y\\e\\h\\j\\b","\\q\\S\\h\\G\\f\\b\\j\\E\\A","\\f\\e\\h\\y\\1i\\y\\Y\\G\\f\\b\\j\\V\\j\\h\\v\\s","\\f\\e\\h\\y\\1i\\y\\Y\\G\\f\\b\\j\\J\\h\\t\\s\\g\\n\\F","\\q\\S\\h\\V\\j\\h\\v\\s\\E\\A\\J\\h\\t\\s\\g\\n\\F","\\q\\S\\h\\V\\j\\h\\v\\s\\E\\A\\V\\j\\h\\v\\s","\\t\\h\\v\\f\\b\\p\\h\\1b\\n","\\k\\p","\\s\\n\\l\\G\\f\\b\\j\\V\\j\\h\\v\\s","\\s\\n\\l\\G\\f\\b\\j\\J\\h\\t\\s\\g\\n\\F","\\h\\n","\\r\\b\\e\\1g\\l","\\k\\f\\J\\z\\g\\n\\r\\b","\\H\\k\\j\\f\\e","\\q\\h\\t\\S\\h","\\r\\j\\p\\y\\1i\\y\\Y\\G\\f\\b\\j\\V\\j\\h\\v\\s","\\r\\j\\k\\p","\\r\\j\\p\\y\\1i\\y\\Y\\G\\f\\b\\j\\J\\h\\t\\s\\g\\n\\F","\\s\\j\\b\\1m","\\n\\b\\1F\\e","\\l\\g\\f\\e","","\\j\\b\\H\\j\\b\\f\\z","\\f\\z\\h\\1b","\\t\\b\\f\\f\\g\\r\\b","\\F\\b\\f","\\f\\b\\e\\1l\\g\\l\\v\\b","\\k\\f\\E\\n\\f\\b\\j\\e","\\k\\n\\f\\b\\j\\e","\\n\\b\\1b","\\1m\\g\\l\\v\\b","\\k\\f\\A\\b\\l\\b\\e\\b","\\p\\b\\l\\b\\e\\b\\A\\g\\e\\g","\\k\\e\\b\\t\\f","\\f\\b\\l\\b\\q\\e\\b\\p","\\f\\l\\t\\y\\1i\\y\\Y\\G\\f\\b\\j\\V\\j\\h\\v\\s","\\f\\l\\t\\y\\1i\\y\\Y\\G\\f\\b\\j\\J\\h\\t\\s\\g\\n\\F","\\p\\b\\l\\b\\e\\b","\\k\\f\\G\\s\\p\\g\\e\\b","\\H\\j\\t\\1M\\g\\k\\n","\\q\\z\\b\\q\\P\\R\\b\\1E\\v\\k\\j\\b\\1C\\g\\f\\f","\\H\\h\\j\\t","\\1g\\t\\g\\k\\l","\\q\\z\\b\\q\\P\\1g\\t\\g\\k\\l","\\v\\e\\k\\l","\\f\\e\\h\\j\\b","\\f\\g\\1m\\b","\\s\\j\\k\\n\\e","\\q\\l\\h\\f\\b","\\H\\h\\q\\v\\f","\\s\\g\\j\\b\\n\\e\\L\\v\\e\\h\\1c\\h\\g\\p\\J\\h\\n\\e\\j\\h\\l","\\r\\b\\e\\2l\\b\\k\\r\\z\\e","\\f\\b\\e\\2l\\b\\k\\r\\z\\e","\\z\\b\\k\\r\\z\\e","\\r\\b\\e\\1l\\k\\b\\1b\\y\\k\\3I\\b","\\r\\b\\e\\1q\\h\\p\\F","\\k\\f\\2m\\k\\j\\f\\e\\1c\\h\\g\\p","\\1m\\g\\l\\v\\b\\1M\\h\\p\\b\\l\\f","\\q\\h\\l\\l\\g\\s\\f\\b","\\q\\z\\b\\q\\P\\b\\p","\\q\\z\\P\\L\\v\\e\\h","\\r\\b\\e\\1l\\g\\l\\v\\b","\\f\\b\\e\\A\\k\\f\\g\\S\\l\\b\\p","\\v\\s\\p\\g\\e\\b\\R\\b\\q\\h\\j\\p","\\r\\b\\e\\2m\\h\\j\\t","\\y\\L\\C\\C\\1x\\C\\C","\\q\\z\\g\\n\\r\\b\\A\\g\\e\\g","\\k\\f\\3H\\b\\1b","\\f\\b\\e\\R\\b\\g\\p\\1P\\n\\l\\F","\\l\\h\\g\\p\\k\\n\\r\\p\\g\\e\\g","\\H\\h\\j\\q\\b\\y\\b\\l\\b\\q\\e\\k\\h\\n","\\l\\b\\n\\r\\e\\z","\\p\\g\\e\\g","\\G\\f\\b\\j\\E\\A","\\k\\n\\f\\b\\j\\e\\1q\\l\\g\\n\\P","\\r\\b\\e\\L\\e","\\f\\b\\e\\R\\b\\1E\\v\\k\\j\\b","\\q\\h\\t\\t\\k\\e\\J\\z\\g\\n\\r\\b\\f","\\l\\h\\g\\p\\R\\b\\q\\h\\j\\p","\\E\\t\\g\\r\\b\\f","\\k\\t\\r\\E\\t\\g\\r\\b\\f","\\f\\b\\e\\E\\t\\g\\r\\b\\G\\j\\l","\\s\\n\\l\\1C\\1P\\Y\\1C\\j\\k\\q\\b\\J\\s\\n\\F","\\q\\l\\h\\f\\b\\1f\\g\\S","\\e\\g\\S\\A\\b\\e\\g\\k\\l","\\g\\p\\p\\1f\\g\\S","\\q\\z\\b\\q\\P\\1q\\b\\H\\h\\j\\b\\1g\\p\\k\\e","\\q\\z\\b\\q\\P\\E\\n\\f\\b\\j\\e\\3J\\b\\F","\\H\\k\\b\\l\\p","\\H\\k\\n\\p\\R\\b\\q\\h\\j\\p","\\A\\b\\f\\q\\j","\\f\\b\\e","\\j\\b\\q\\h\\j\\p","\\q\\z\\b\\q\\P\\1l\\g\\l\\k\\p\\g\\e\\b\\1g\\p\\k\\e","\\q\\z\\b\\q\\P\\R\\b\\1z\\b\\q\\e","\\1c\\k\\f\\e\\J\\s\\n\\F","\\k\\f\\1l\\g\\l\\k\\p","\\3K\\g\\k\\e\\1M\\f\\r","\\y\\L\\C\\C\\1x\\C\\C\\1w\\y\\g\\1m\\b","\\r\\b\\e\\R\\b\\q\\h\\j\\p","\\r\\b\\e\\A\\g\\e\\g","\\s\\j\\h\\q\\b\\f\\f","\\f\\v\\S\\t\\k\\e","\\A\\b\\l\\b\\e\\k\\n\\r\\A\\g\\e\\g","\\y\\L\\C\\C\\1x\\C\\C\\1w\\A\\b\\l\\b\\e\\b\\L\\l\\l","\\p\\b\\l\\b\\e\\b\\y\\b\\l\\b\\q\\e\\b\\p","\\y\\L\\C\\C\\1x\\C\\C\\1w\\E\\t\\g\\r\\b\\1f\\h\\1q\\k\\n","\\1C\\1P\\y\\1f","\\g\\s\\s\\l\\k\\q\\g\\e\\k\\h\\n\\1w\\1z\\f\\h\\n","\\f\\e\\j\\k\\n\\r\\k\\H\\F","\\j\\b\\f\\s\\h\\n\\f\\b\\1f\\b\\1F\\e","\\p\\b\\q\\h\\p\\b","\\k\\t\\r\\y\\j\\q","\\j\\b\\1E\\v\\b\\f\\e","\\L\\1z\\g\\1F","\\H\\k\\l\\b\\f","\\p\\h\\t","\\H\\k\\l\\b\\E\\n\\s\\v\\e\\1g\\l","\\h\\n\\l\\h\\g\\p","\\j\\b\\f\\v\\l\\e","\\e\\g\\j\\r\\b\\e","\\j\\b\\g\\p\\L\\f\\A\\g\\e\\g\\G\\R\\1c","\\e\\h\\1c\\h\\1b\\b\\j\\J\\g\\f\\b","\\s\\h\\s","\\3Y","\\f\\s\\l\\k\\e","\\1z\\s\\r","\\s\\n\\r","\\r\\k\\H","\\z\\p\\n\\E\\t\\g\\r\\b\\f","\\j\\b\\f\\b\\e","\\H\\v\\s\\E\\t\\g\\r\\b\\f"];m W=[a[0]];m 2c=[a[0]];m 2E=[a[0]];m 1j=[a[0]];m 2k=[a[0]];m 2j=[a[0]];m x=0;m 2A=o(){d[a[3]][a[4]](B,d[a[3]][a[2]](a[1]));c[a[9]][a[8]]()[a[7]](o(){c[a[6]][a[5]]()})};m 2s=o(){d[a[3]][a[4]](B,d[a[3]][a[2]](a[1]));c[a[13]][a[8]]()[a[7]](o(){c[a[12]][a[8]]()[a[7]](o(){c[a[10]][a[5]]();c[a[11]][a[5]]();d[a[3]][a[4]](I,d[a[3]][a[2]](a[1]))})})};m 3f=o(1v){1v[a[19]]()[a[18]](a[14],o(){i(1v[a[15]]==a[16]){x=1}u{i(1v[a[15]]==a[17]){x=2}u{x=0}}})};m 1r=o(2h){3i(2h){N a[21]:i(x==0){d[a[22]][a[21]](c[a[9]],d[a[20]])}u{i(x==1){d[a[24]][a[21]](c[a[23]])}u{i(x==2){d[a[24]][a[21]](c[a[25]])}}};M;N a[26]:i(x==0){d[a[22]][a[26]](c[a[9]],d[a[20]])}u{i(x==1){d[a[24]][a[26]](c[a[23]])}u{i(x==2){d[a[24]][a[26]](c[a[25]])}}};M;N a[27]:i(x==0){d[a[22]][a[27]](c[a[9]],d[a[20]])}u{i(x==1){d[a[24]][a[27]](c[a[23]])}u{i(x==2){d[a[24]][a[27]](c[a[25]])}}};M;N a[28]:i(x==0){d[a[22]][a[28]](c[a[9]],d[a[20]])}u{i(x==1){d[a[24]][a[28]](c[a[23]])}u{i(x==2){d[a[24]][a[28]](c[a[25]])}}};M;N a[30]:i(d[a[20]]){d[a[32]][a[31]](3c,a[29],a[30])}u{1Q(a[33])};M;N a[37]:i(x==0){c[a[9]][a[34]](a[29]);c[a[10]][a[5]]();c[a[11]][a[5]]()}u{i(x==1){i(d[a[35]]){d[a[24]][a[36]](c[a[23]])}}u{i(x==2){i(d[a[35]]){d[a[24]][a[36]](c[a[25]])}}}};M;N a[45]:i(x==0){i(c[a[9]][a[38]]){i(d[a[39]]){d[a[32]][a[31]](11,a[29],a[40])}}u{1r(a[37])}}u{i(x==1){i(c[a[43]][a[42]][a[41]][0]!=2e){i(d[a[39]]){d[a[32]][a[31]](11,a[29],a[40])}}}u{i(x==2){i(c[a[44]][a[42]][a[41]][0]!=2e){i(d[a[39]]){d[a[32]][a[31]](11,a[29],a[40])}}}}};M;N a[2X]:i(d[a[46]]||d[a[35]]||d[a[39]]){i(d[a[49]][a[48]](c[a[47]])&&d[a[2Y]][a[3b]](c[a[4b]][a[38]])&&d[a[D]][a[48]](c[a[10]],W,2c,2E)&&d[a[D]][a[48]](c[a[11]],W,2k,2j)){2W()}};M;N a[3t]:M;N a[2n]:d[a[3]][a[2n]](1Z);M}};m 3s=o(O){i(c[2p]){c[2p][a[2u]]()}};m 3m=o(1Y){i(1Z[a[2C]]!=1k){1Y[a[2v]](1Z[a[2C]][a[3o]]()-T)}u{1Y[a[2v]](1X[a[3S]]()[a[4w]]()[a[4F]]-T)}};m 4G=o(1s,2a){d[a[1n]]=B;i(1s[a[1J]]!=1k){c[a[6]][a[5]]();2B()}};m 4H=o(1s,2a){i(d[a[20]]){c[a[9]][a[4E]]()}};m 4D=o(1s,2a){i(d[a[20]]){d[a[32]][a[31]](4B,a[29],a[29])}u{1r(a[37])}};o 2B(){i(c[a[2o]][a[2i]]){i(c[a[9]][a[1G]]()==1k||c[a[9]][a[1G]]()==a[29]){c[a[9]][a[1N]](B)}u{c[a[9]][a[1N]](I);c[a[2o]][a[2i]]}}u{c[a[9]][a[1N]](I)}}m 4Q=o(){d[a[1n]]=B;2A()};m X=o(){c[a[47]][a[2r]]()[a[1D]]();d[a[20]]=(d[a[D]][a[20]](c[a[6]])==I?d[a[D]][a[20]](c[a[10]]):B)||(d[a[D]][a[20]](c[a[6]])==I?d[a[D]][a[20]](c[a[11]]):B);d[a[3]][a[4O]](d[a[20]],a[4L]);i(c[a[9]][a[1J]]==1k||d[a[1R]]==B){c[a[9]][a[2z]](I)}u{c[a[9]][a[2z]](d[a[20]])}};m 4i=o(K){d[a[3]][a[4]](B,d[a[3]][a[2]](a[4k]))};m 4m=o(K){d[a[1n]]=B;d[a[1R]]=I;d[a[3]][a[4]](I);c[a[9]][a[2w]]=B;i(K[a[1d]][a[4t]]==0){d[a[D]][a[1K]](K,a[4s]);Q=K[a[2t]](0);d[a[1R]]=B;c[a[9]][a[2w]]=I;d[a[3]][a[4u]](c[a[47]]);c[a[9]][a[2u]](B);K[a[4l]]()};m Q=K[a[2t]](0);c[a[47]][a[2r]]()[a[4N]](Q);2s();i(Q[a[1d]][a[4K]]){2I(c[a[1B]],Q[a[1d]].4P)}u{c[a[1B]][a[1p]](a[29])}};m 4T=o(4I,2x){i(2x){c[a[2y]][a[4d]](c[a[2D]])}u{c[a[2y]][a[4M]](c[a[2D]])}};m 4x=o(O,2S,2R){};m 4r=o(K){i(d[a[1n]]){i(d[a[35]]){d[a[D]][a[1K]](K,W)}};X();d[a[3]][a[4]](I)};m 4q=o(2F,w){i(!d[a[24]][a[4p]](w,W)){1I I}};m 4o=o(O,w){d[a[24]][a[1L]](c[a[23]],w,W);X();i(w[a[1u]]==a[0]){m 1a=c[a[13]][a[D]][a[2f]](w[a[1u]],w[a[38]]);i(1a){w[a[T]][a[1h]](a[1t],1a[a[1d]].2d)}u{w[a[T]][a[1h]](a[1t],a[29])}}};m 4n=o(O,w){1I d[a[24]][a[2q]](c[a[23]],w,W)};m 4e=o(Q){d[a[24]][a[2V]](Q,c[a[23]]);X()};m 4c=o(K){i(d[a[1n]]){i(d[a[35]]){d[a[D]][a[1K]](K,1j)}};X();d[a[3]][a[4]](I)};m 4S=o(2F,w){d[a[24]][a[1L]](c[a[25]],w,1j)};m 4f=o(O,w){d[a[24]][a[1L]](c[a[25]],w,1j);X();i(w[a[1u]]==a[0]){m 1a=c[a[12]][a[D]][a[2f]](w[a[1u]],w[a[38]]);i(1a){w[a[T]][a[1h]](a[2g],1a[a[1d]].3j);w[a[T]][a[1h]](a[1t],1a[a[1d]].2d)}u{w[a[T]][a[1h]](a[2g],a[29]);w[a[T]][a[1h]](a[1t],a[29])}}};m 3L=o(O,w){1I d[a[24]][a[2q]](c[a[25]],w,1j)};m 3w=o(Q){d[a[24]][a[2V]](Q,c[a[25]]);X()};m 2W=o(){i(c[a[47]][a[2T]]()){c[a[47]][a[1D]]();c[a[47]][a[2K]]({2L:d[a[3]][a[2]](a[3Z]),2b:a[3d],2U:{3g:d[a[D]][a[1O]](c[a[47]][a[3a]]()[a[D]]),4C:d[a[D]][a[1O]](c[a[11]]),4J:d[a[D]][a[1O]](c[a[10]])},1W:o(1e,U){d[a[32]][a[31]](4j);c[a[9]][a[8]]()[a[5]]();1Q(a[33])},1U:o(1e,U){d[a[32]][a[1S]](1e,U,B)}})}};m 4g=o(O){i(O==a[33]){i(x==0){i(c[a[47]][a[2T]]()){c[a[47]][a[1D]]();c[a[47]][a[2K]]({2L:d[a[3]][a[2]](a[4R]),2b:a[4y],4h:4v,1W:o(1e,U){c[a[9]][a[8]]()[a[7]]();1r(a[37])},1U:o(1e,U){d[a[32]][a[1S]](1e,U,B)}})}}u{i(x==1){c[a[23]][a[2J]]()}u{i(x==2){c[a[25]][a[2J]]()}}}}};m 2I=o(1o,2G){1X[a[4A]][a[4z]]({2b:a[3p],3q:a[3n],3l:{"\\J\\h\\n\\e\\b\\n\\e\\3r\\1f\\F\\s\\b":a[3x]},2U:3v[a[3k]]({3y:2G}),1W:o(2H){m 1V=1X[a[2Z]](2H[a[3h]]);i(1V[a[2M]]){1o[a[1p]](1V[a[2M]])}u{1o[a[1p]](a[29])}},1U:o(2N,U){d[a[32]][a[1S]](2N,U,B)}})};m 2Q=o(Z,1o){m 1A=Z[a[3e]][a[3u]][a[4a]];i(1A&&1A[0]){m 1T=3z 3R();1T[a[3Q]]=o(w){1o[a[1p]](w[a[3O]][a[3P]])};1T[a[3T]](1A[0])}};m 3U=o(Z,2S,2R,2O){i(Z[a[38]]){m 1y=Z[a[38]][a[3X]](a[3V])[a[3W]]()[a[3N]]();i(1y==a[3M]||1y==a[3E]||1y==a[3D]){c[a[2P]][a[34]](Z[a[38]]);2Q(Z,c[a[1B]])}u{d[a[32]][a[31]](3C,a[29],a[29])}}};m 3A=o(3B,2O){c[a[3F]][a[3G]]();c[a[1B]][a[1p]](a[29]);c[a[2P]][a[34]](a[29])};o 1Q(O){i(O==a[33]){d[a[20]]=I;m 1H=a[29];i(c[a[9]][a[1J]]!=1k){1H=c[a[9]][a[1G]]()};c[a[9]][a[8]]()[a[7]](o(){c[a[9]][a[34]](1H);c[a[6]][a[5]]()})}}', 62, 304, '||||||||||_0xed4a|x65|App|HQ|x74|x73|x61|x6F|if|x72|x69|x6C|var|x6E|function|x64|x63|x67|x70|x6D|else|x75|_0x8bd0x27|_focusNo|x53|x68|x44|true|x30|53|x49|x79|x55|x66|false|x43|_0x8bd0x1b|x41|break|case|_0x8bd0xf|x6B|_0x8bd0x1d|x52|x62|100|_0x8bd0x33|x47|keys|frmChange|x5F|_0x8bd0x3c|||||||||||_0x8bd0x29|x77|x4C|80|_0x8bd0x32|x54|x45|99|x59|keys1|null|x56|x76|64|_0x8bd0x36|89|x42|menuClick|_0x8bd0x13|98|96|_0x8bd0xb|x2F|x33|_0x8bd0x41|x6A|_0x8bd0x3d|88|x50|71|x71|x78|69|_0x8bd0x45|return|65|82|95|x4D|70|108|x4F|refresh|75|109|_0x8bd0x3e|failure|_0x8bd0x39|success|Ext|_0x8bd0x11|this|||||||||||_0x8bd0x14|url|fieldsCheckRequireUserGroup|Descr|undefined|97|103|_0x8bd0xd|67|fieldsLangCheckRequireUserCompany|fieldsCheckRequireUserCompany|x48|x46|56|68|invalidField|101|72|loadComboGrid|83|57|60|78|_0x8bd0x20|92|76|loadSourceCombo|chkAutoChange|58|90|fieldsLangCheckRequireUserGroup|_0x8bd0x26|_0x8bd0x37|_0x8bd0x38|displayImage|113|110|waitMsg|120|_0x8bd0x3a|_0x8bd0x40|137|readImage|_0x8bd0x23|_0x8bd0x22|104|params|102|save|54|52|119|||||||||||107|51|20150303|106|125|pnl_render|lstUser|118|switch|ListCpny|117|headers|tabDetail_AfterRender|115|59|114|method|x2D|focusChecking|55|124|JSON|grdSYS_UserCompany_Reject|116|fileName|new|btnClearImage_click|_0x8bd0x43|148|136|135|139|138|x4E|x7A|x4B|x57|grdSYS_UserCompany_ValidateEdit|134|130|128|127|126|FileReader|63|129|fupImages_change|132|131|133|x2E|105|||||||||||123|50|stoSYS_UserCompany_Load|91|grdSYS_UserGroup_Reject|grdSYS_UserCompany_Edit|deleteData|timeout|stoBeforeLoad|201405071|77|85|stoLoad|grdSYS_UserGroup_ValidateEdit|grdSYS_UserGroup_Edit|94|grdSYS_UserGroup_BeforeEdit|stoSYS_UserGroup_Load|81|79|84|7200|62|cboInvtID_Change|112|121|122|150|lstSYS_UserCompany|cboUserID_TriggerClick|66|61|cboUserID_Change|cboUserID_Expand|_0x8bd0x1f|lstSYS_UserGroup|87|73|93|86|74|Images|firstLoad|111|grdSYS_UserCompany_BeforeEdit|chkPublic_Change'.split('|'), 0, {}))


var keys = ['GroupID'];
var fieldsCheckRequireUserGroup = ["GroupID"];
var fieldsLangCheckRequireUserGroup = ["GroupID"];


var keys1 = ['GroupID'];
var fieldsCheckRequireUserCompany = ["GroupID"];
var fieldsLangCheckRequireUserCompany = ["GroupID"];

var _focusNo = 0;

var loadSourceCombo = function () {
    HQ.common.showBusy(true, HQ.common.getLang("loadingData"));
    App.cboUserID.getStore().load(function () {
        App.stoUser.reload();

    });
};

var loadComboGrid = function () {
    HQ.common.showBusy(true, HQ.common.getLang("loadingData"));
    App.cboGroupIDGroup.getStore().load(function () {
        App.cboGroupIDCompany.getStore().load(function () {
            App.stoSYS_UserGroup.reload();
            App.stoSYS_UserCompany.reload();
            HQ.common.showBusy(false, HQ.common.getLang("loadingData"));
        })
    });
};

var pnl_render = function (cmd) {
    cmd.getEl().on('mousedown', function () {
        if (cmd.id == 'pnlUserGroup') {
            _focusNo = 1;
        }
        else if (cmd.id == 'pnlUserCompany') {
            _focusNo = 2;
        }
        else {//pnlHeader
            _focusNo = 0;
        }
    });
};

var menuClick = function (command) {
    switch (command) {
        case "first":
            if (_focusNo == 0) {
                HQ.combo.first(App.cboUserID, HQ.isChange);
            }
            else if (_focusNo == 1) {
                HQ.grid.first(App.grdSYS_UserGroup);
            }
            else if (_focusNo == 2) {
                HQ.grid.first(App.grdSYS_UserCompany);
            }
            break;
        case "prev":
            if (_focusNo == 0) {
                HQ.combo.prev(App.cboUserID, HQ.isChange);
            }
            else if (_focusNo == 1) {
                HQ.grid.prev(App.grdSYS_UserGroup);
            }
            else if (_focusNo == 2) {
                HQ.grid.prev(App.grdSYS_UserCompany);
            }
            break;
        case "next":
            if (_focusNo == 0) {
                HQ.combo.next(App.cboUserID, HQ.isChange);
            }
            else if (_focusNo == 1) {
                HQ.grid.next(App.grdSYS_UserGroup);
            }
            else if (_focusNo == 2) {
                HQ.grid.next(App.grdSYS_UserCompany);
            }
            break;
        case "last":
            if (_focusNo == 0) {
                HQ.combo.last(App.cboUserID, HQ.isChange);
            }
            else if (_focusNo == 1) {
                HQ.grid.last(App.grdSYS_UserGroup);
            }
            else if (_focusNo == 2) {
                HQ.grid.last(App.grdSYS_UserCompany);
            }
            break;
        case "refresh":
            if (HQ.isChange) {
                HQ.message.show(20150303, '', 'refresh');
            }
            else {
                refresh("yes");
            }
            break;
        case "new":
            if (_focusNo == 0) {
                App.cboUserID.setValue("");
                App.stoSYS_UserGroup.reload();
                App.stoSYS_UserCompany.reload();
            }
            else if (_focusNo == 1) {
                if (HQ.isInsert) {
                    HQ.grid.insert(App.grdSYS_UserGroup);
                }
            }
            else if (_focusNo == 2) {
                if (HQ.isInsert) {
                    HQ.grid.insert(App.grdSYS_UserCompany);
                }
            }
            break;
        case "delete":
            if (_focusNo == 0) {
                if (App.cboUserID.value) {
                    if (HQ.isDelete) {
                        HQ.message.show(11, '', 'deleteData');
                    }
                } else {
                    menuClick('new');
                }
            }
            else if (_focusNo == 1) {
                if (App.slmSYS_UserGroup.selected.items[0] != undefined) {
                    if (HQ.isDelete) {
                        HQ.message.show(11, '', 'deleteData');
                    }
                }
            }
            else if (_focusNo == 2) {
                if (App.slmSYS_UserCompany.selected.items[0] != undefined) {
                    if (HQ.isDelete) {
                        HQ.message.show(11, '', 'deleteData');
                    }
                }
            }
            break;
        case "save":
            if (HQ.isUpdate || HQ.isInsert || HQ.isDelete) {
                if (HQ.form.checkRequirePass(App.frmMain) && HQ.util.checkEmail(App.Email.value) && HQ.store.checkRequirePass(App.stoSYS_UserGroup, keys, fieldsCheckRequireUserGroup, fieldsLangCheckRequireUserGroup)
                        && HQ.store.checkRequirePass(App.stoSYS_UserCompany, keys, fieldsCheckRequireUserCompany, fieldsLangCheckRequireUserCompany)) {
                    save();
                }
            }
            break;
        case "print":
            break;
        case "close":
            HQ.common.close(this);
            break;
    }
};

var focusChecking = function (item) {
    if (App[invalidField]) {
        App[invalidField].focus();
    }
};

var tabDetail_AfterRender = function (obj) {
    if (this.parentAutoLoadControl != null)
        obj.setHeight(this.parentAutoLoadControl.getHeight() - 100);
    else {
        obj.setHeight(Ext.getBody().getViewSize().height - 100);
    }
};

var cboUserID_Change = function (sender, value) {
    HQ.isFirstLoad = true;
    if (sender.valueModels != null) {
        App.stoUser.reload();
        chkAutoChange();
    }
};

//khi nhan combo xo ra, neu da thay doi thi ko xo ra
var cboUserID_Expand = function (sender, value) {
    if (HQ.isChange) {
        App.cboUserID.collapse();
    }
};

//khi nhan X xoa tren combo, neu du lieu thay doi thi ko cho xoa, du lieu chua thay doi thi add new
var cboUserID_TriggerClick = function (sender, value) {
    if (HQ.isChange) {
        HQ.message.show(150, '', '');
    }
    else {
        menuClick('new');
    }

};

function chkAutoChange() {
    //if (App.chkAuto.checked) {
    //    if (App.cboUserID.getValue() == null || App.cboUserID.getValue() == '') {
    //        App.cboUserID.setDisabled(true);
    //    }
    //    else {
    //        App.cboUserID.setDisabled(false);
    //        App.chkAuto.checked
    //    }
    //}
    //else {
    //    App.cboUserID.setDisabled(false);
    //}
    if (App.chkAuto.checked) {
        App.cboUserID.setValue('');
        App.cboUserID.setDisabled(true);
    }
    else {
        App.cboUserID.setDisabled(false);
    }
};

var firstLoad = function () {
    HQ.isFirstLoad = true;
    loadSourceCombo();
};

////////////Kiem tra combo chinh CpnyID
//khi co su thay doi du lieu cua cac conttol tren form
var frmChange = function () {
    App.frmMain.getForm().updateRecord();
    HQ.isChange = (HQ.store.isChange(App.stoUser) == false ? HQ.store.isChange(App.stoSYS_UserGroup) : true) || (HQ.store.isChange(App.stoUser) == false ? HQ.store.isChange(App.stoSYS_UserCompany) : true);
    HQ.common.changeData(HQ.isChange, 'SA00300');
    if (App.cboUserID.valueModels == null || HQ.isNew == true)
        App.cboUserID.setReadOnly(false);
    else App.cboUserID.setReadOnly(HQ.isChange);
};

var stoBeforeLoad = function (sto) {
    HQ.common.showBusy(true, HQ.common.getLang('loadingdata'));
};

var stoLoad = function (sto) {
    HQ.isFirstLoad = true;
    HQ.isNew = false;
    HQ.common.showBusy(false);
    App.cboUserID.forceSelection = true;
    if (sto.data.length == 0) {
        HQ.store.insertBlank(sto, "UserID");
        record = sto.getAt(0);

        HQ.isNew = true;//record la new    
        App.cboUserID.forceSelection = false;
        HQ.common.setRequire(App.frmMain);  //to do cac o la require            
        App.cboUserID.focus(true);//focus ma khi tao moi
        sto.commitChanges();
    }
    var record = sto.getAt(0);
    App.frmMain.getForm().loadRecord(record);
    loadComboGrid();
    // display image
    if (record.data.Images) {
        displayImage(App.imgImages, record.data.Images);
    }
    else {
        App.imgImages.setImageUrl("");
    }
};

var chkPublic_Change = function (checkbox, checked) {
    if (checked) {
        App.tabDetail.closeTab(App.pnlPO_PriceCpny);
    }
    else {
        App.tabDetail.addTab(App.pnlPO_PriceCpny);
    }
};

var cboInvtID_Change = function (item, newValue, oldValue) {

};

//grd SYS_UserGroup
var stoSYS_UserGroup_Load = function (sto) {
    if (HQ.isFirstLoad) {
        if (HQ.isInsert) {
            HQ.store.insertBlank(sto, keys);
        }
        //HQ.isFirstLoad = false;
    }
    frmChange();
    HQ.common.showBusy(false);
};

var grdSYS_UserGroup_BeforeEdit = function (editor, e) {
    if (!HQ.grid.checkBeforeEdit(e, keys)) return false;
};

var grdSYS_UserGroup_Edit = function (item, e) {
    //Kiem tra cac key da duoc nhap se insert them dong moi
    HQ.grid.checkInsertKey(App.grdSYS_UserGroup, e, keys);
    frmChange();
    if (e.field == "GroupID") {
        var selectedRecord = App.cboGroupIDGroup.store.findRecord(e.field, e.value);
        if (selectedRecord) {
            e.record.set("Descr", selectedRecord.data.Descr);
        }
        else {
            e.record.set("Descr", "");
        }
    }

};

var grdSYS_UserGroup_ValidateEdit = function (item, e) {
    //ko cho nhap key co ki tu dac biet, va kiem tra trung du lieu
    return HQ.grid.checkValidateEdit(App.grdSYS_UserGroup, e, keys);
};

var grdSYS_UserGroup_Reject = function (record) {
    //reject dong thay doi du lieu ve ban dau
    HQ.grid.checkReject(record, App.grdSYS_UserGroup);
    frmChange();
};


//grd SYS_UserCompany
var stoSYS_UserCompany_Load = function (sto) {
    if (HQ.isFirstLoad) {
        if (HQ.isInsert) {
            HQ.store.insertBlank(sto, keys1);
        }
        //HQ.isFirstLoad = false;
    }
    frmChange();
    HQ.common.showBusy(false);
};

var grdSYS_UserCompany_BeforeEdit = function (editor, e) {
    //Kiem tra cac key da duoc nhap se insert them dong moi
    HQ.grid.checkInsertKey(App.grdSYS_UserCompany, e, keys1);

};

var grdSYS_UserCompany_Edit = function (item, e) {
    //Kiem tra cac key da duoc nhap se insert them dong moi
    HQ.grid.checkInsertKey(App.grdSYS_UserCompany, e, keys1);
    frmChange();
    if (e.field == "GroupID") {
        var selectedRecord = App.cboGroupIDCompany.store.findRecord(e.field, e.value);
        if (selectedRecord) {
            e.record.set("ListCpny", selectedRecord.data.ListCpny);
            e.record.set("Descr", selectedRecord.data.Descr);
        }
        else {
            e.record.set("ListCpny", "");
            e.record.set("Descr", "");
        }
    }

};

var grdSYS_UserCompany_ValidateEdit = function (item, e) {
    //ko cho nhap key co ki tu dac biet, va kiem tra trung du lieu
    return HQ.grid.checkValidateEdit(App.grdSYS_UserCompany, e, keys1);
};

var grdSYS_UserCompany_Reject = function (record) {
    //reject dong thay doi du lieu ve ban dau
    HQ.grid.checkReject(record, App.grdSYS_UserCompany);
    frmChange();
};

var save = function () {
    if (App.frmMain.isValid()) {
        App.frmMain.updateRecord();
        App.frmMain.submit({
            waitMsg: HQ.common.getLang("WaitMsg"),
            url: 'SA00300/Save',
            params: {
                lstUser: HQ.store.getData(App.frmMain.getRecord().store),
                lstSYS_UserCompany: HQ.store.getData(App.stoSYS_UserCompany),
                lstSYS_UserGroup: HQ.store.getData(App.stoSYS_UserGroup),
                Auto: App.chkAuto.getValue()
            },
            success: function (msg, data) {
                HQ.message.show(201405071);
                App.chkAuto.setValue(false);
                //refresh("yes");
                var UserID = data.result.UserID;
                App.cboUserID.getStore().load(function () {
                    App.cboUserID.setValue(UserID);
                    App.stoUser.reload();
                });
            },
            failure: function (msg, data) {
                HQ.message.process(msg, data, true);
                App.fupImages.reset();
                App.imgImages.setImageUrl("");
                App.hdnImages.setValue("");
            }
        });
    }
};

var deleteData = function (item) {
    if (item == "yes") {
        if (_focusNo == 0) {
            if (App.frmMain.isValid()) {
                App.frmMain.updateRecord();
                App.frmMain.submit({
                    waitMsg: HQ.common.getLang("DeletingData"),
                    url: 'SA00300/DeleteAll',
                    timeout: 7200,
                    success: function (msg, data) {
                        App.cboUserID.getStore().load();
                        menuClick("new");
                    },
                    failure: function (msg, data) {
                        HQ.message.process(msg, data, true);
                    }
                });
            }

        }
        else if (_focusNo == 1) {
            App.grdSYS_UserGroup.deleteSelected();
        }
        else if (_focusNo == 2) {
            App.grdSYS_UserCompany.deleteSelected();
        }
    }
};

var displayImage = function (imgControl, fileName) {
    Ext.Ajax.request({
        url: 'SA00300/ImageToBin',
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        params: JSON.stringify({
            fileName: fileName
        }),
        success: function (result) {
            var jsonData = Ext.decode(result.responseText);
            if (jsonData.imgSrc) {
                imgControl.setImageUrl(jsonData.imgSrc);
            }
            else {
                imgControl.setImageUrl("");
            }
        },
        failure: function (errorMsg, data) {
            HQ.message.process(errorMsg, data, true);
        }
    });
};

var readImage = function (fup, imgControl) {
    var files = fup.fileInputEl.dom.files;
    if (files && files[0]) {
        var FR = new FileReader();
        FR.onload = function (e) {
            imgControl.setImageUrl(e.target.result);
        };
        FR.readAsDataURL(files[0]);
    }
};

var fupImages_change = function (fup, newValue, oldValue, eOpts) {
    if (fup.value) {
        var ext = fup.value.split(".").pop().toLowerCase();
        if (ext == "jpg" || ext == "png" || ext == "gif") {
            App.hdnImages.setValue(fup.value);
            readImage(fup, App.imgImages);
        }
        else {
            HQ.message.show(148, '', '');
        }
    }
};

var btnClearImage_click = function (btn, eOpts) {
    App.fupImages.reset();
    App.imgImages.setImageUrl("");
    App.hdnImages.setValue("");
};

function refresh(item) {
    if (item == 'yes') {
        HQ.isChange = false;
        //var userid = '';
        //userid = App.cboUserID.getValue();
        //App.cboUserID.getStore().load(function () {
        //    App.cboUserID.setValue(userid);

        //});
        App.stoUser.reload();
    }
};