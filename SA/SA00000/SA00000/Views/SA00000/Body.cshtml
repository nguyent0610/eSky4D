@using Ext.Net;
@using Ext.Net.MVC;
@using HQ.eSkyFramework;
@using HQ.eSkyFramework.HQControl;
@using SA00000;
@{
    Layout = null;
    var X = Html.X();
    var HQ = Html.HQ();
}

@(X.Viewport()
.Layout(LayoutType.Fit)
.Items(
    X.FormPanel()
    .ID("frmMain")  
    .KeyMap(Util.SetupKeyMap())
    .TopBar(Util.SetupToolbar("Print", true, ""))
    .Layout(LayoutType.Border)
    .FieldDefaults(act => { act.LabelAlign = LabelAlign.Right; act.LabelWidth = 200; })
    .Listeners(l =>
    {
        //l.BoxReady.Handler = "firstLoad();";
        //l.FieldChange.Fn = "frmChange";
    })
    .Items(
        ////Thiet ke giao dien o day
        X.Panel().ID("pnlHeader")
        .Region(Region.North)
        .Items(
            X.Container().Layout(LayoutType.VBox).MarginSpec("0 0 5 0")
                .Items(
                    HQ.Combo().ID("cboCpnyID")
                    .Name("cboCpnyID").HQLangCode("CPNYID").HQDBSys(true).AllowBlank(false).MarginSpec("5 0 0 0")
                    .HQProcedure("SA00000_pcCompanyAll").HQColumnShow("CpnyID,CpnyName").DisplayField("CpnyID").ValueField("CpnyID")
                    .HQHeightWidth(400, 400).Width(600)
                    .LoadData()
                    .Triggers(new FieldTrigger() { Icon = TriggerIcon.Clear, HideTrigger = false })
                    .Listeners(lst => { 
                        lst.TriggerClick.Handler = "if (index == 0) { this.clearValue();}";
                        lst.Change.Fn = "cboCpnyID_Change";
                    })
                    , HQ.TextBox().ID("CpnyName").Name("CpnyName").HQLangCode("CPNYNAME").MarginSpec("5 0 0 0").Width(600).AllowBlank(false)
                        
                )
        )
        .Listeners(lss =>
        {
            lss.Render.Fn = "pnl_render";
        })

        , X.TabPanel().ID("tabSA00000")
        .Region(Region.Center)
     
        .Items(
        
            X.Panel().ID("pnlCompany")
            .Title(Util.GetLang("COMPANY"))
            .Layout(LayoutType.Column)               
            .AutoScroll(true)
            .Items(
                
                X.Container().ColumnWidth(.5).Width(600)
                            .Items(                                                                  
                            HQ.TextBox().ID("Address").Name("Address").HQLangCode("ADDRESS").MarginSpec("5 0 0 0").Width(600).AllowBlank(false)
                            ,HQ.TextBox().ID("Address1").Name("Address1").HQLangCode("LastName").MarginSpec("5 0 0 0").Width(600).AllowBlank(false)
                            ,HQ.TextBox().ID("Address2").Name("Address2").HQLangCode("Address").MarginSpec("5 0 0 0").Width(600).AllowBlank(false)
                          
                            ,HQ.TextBox().ID("Tel").Name("Tel").HQLangCode("Tel").MarginSpec("5 0 0 0").Width(600).AllowBlank(false)
                            ,HQ.TextBox().ID("Fax").Name("Fax").HQLangCode("Fax").MarginSpec("5 0 0 0").Width(600).AllowBlank(false)
                            ,HQ.TextBox().ID("TaxRegNbr").Name("TaxRegNbr").HQLangCode("TAXREGNBR").MarginSpec("5 0 0 0").Width(600).AllowBlank(false)                           
                            
                            
                            ,HQ.Combo().ID("cboChannel").Name("cboChannel").MarginSpec("5 0 0 0").AllowBlank(false)
                                                    .HQLangCode("CHANNEL").HQProcedure("SA00000_pcAR_Channel")
                                                    .HQColumnShow("Code,Descr")
                                                    .DisplayField("Descr")
                                                    .ValueField("Code")
                                                    .HQHeightWidth(400, 400).Width(600)
                                                    .Triggers(new FieldTrigger() { Icon = TriggerIcon.Clear, HideTrigger = false })
                                                    .Listeners(lst => { lst.TriggerClick.Handler = "if (index == 0) { this.clearValue();}";})
                                                    .LoadData()
                            ,HQ.Combo().ID("cboTerritory").Name("cboTerritory").MarginSpec("5 0 0 0").AllowBlank(false)
                                                    .HQLangCode("TERRITORY").HQProcedure("SA00000_pcTerritory")
                                                    .HQColumnShow("Territory,Descr")
                                                    .DisplayField("Descr")
                                                    .ValueField("Territory")
                                                    .HQHeightWidth(400, 400).Width(600)
                                                    .Triggers(new FieldTrigger() { Icon = TriggerIcon.Clear, HideTrigger = false })
                                                    .Listeners(lst => { lst.TriggerClick.Handler = "if (index == 0) { this.clearValue();}";})
                                                    .HQParam(new StoreParameterCollection() 
                                                    { 
                                                        new StoreParameter() { Name = "@UserID", Value = "HQ.userName", Mode = ParameterMode.Raw }
                                                    })
                                                    .LoadData(),   
                                                    
                            HQ.Combo().ID("cboCountry").Name("cboCountry").HQProcedure("SA00000_pcCountryID").HQLangCode("COUNTRY")
                            .HQColumnShow("CountryID,Descr").DisplayField("Descr").ValueField("CountryID").Width(300).DataIndex("Country")
                            .HQHeightWidth(400, 400).Width(600).MarginSpec("5 0 0 0")
                            .LoadData()
                            .Triggers(new FieldTrigger() { Icon = TriggerIcon.Clear, HideTrigger = false })
                            .Listeners(lst =>
                            {
                                lst.TriggerClick.Handler = "if (index == 0) { this.clearValue();}";
                                lst.Change.Fn = "cboCountry_Change";
                            }),

                            HQ.Combo().ID("cboState").Name("cboState").HQProcedure("SA00000_pcStateByCountry").HQLangCode("State")
                            .HQColumnShow("State,Descr").DisplayField("Descr").ValueField("State").DataIndex("State")
                            .HQHeightWidth(400, 400).Width(600).MarginSpec("5 0 0 0")
                            .HQParam(new StoreParameterCollection() 
                            { 
                                new StoreParameter() { Name = "@Country", Value = "App.cboCountry.getValue()", Mode = ParameterMode.Raw }
                            })
                            .LoadData()
                            .Triggers(new FieldTrigger() { Icon = TriggerIcon.Clear, HideTrigger = false })
                            .Listeners(lst =>
                            {
                                lst.TriggerClick.Handler = "if (index == 0) { this.clearValue();}";
                                lst.Change.Fn = "cboState_Change";
                            }),
                        
                            HQ.Combo().ID("cboCity").Name("cboCity").HQProcedure("SA00000_pcCityByCountryState").HQLangCode("CITY")
                            .HQColumnShow("City,Name").DisplayField("Name").ValueField("City").DataIndex("City")
                            .HQHeightWidth(400, 400).Width(600).MarginSpec("5 0 0 0")
                            .HQParam(new StoreParameterCollection() 
                            { 
                                new StoreParameter() { Name = "@Country", Value = "App.cboCountry.getValue()", Mode = ParameterMode.Raw },
                                new StoreParameter() { Name = "@State", Value = "App.cboState.getValue()", Mode = ParameterMode.Raw }
                            })
                            .LoadData()
                            .Triggers(new FieldTrigger() { Icon = TriggerIcon.Clear, HideTrigger = false })
                            .Listeners(lst =>
                            {
                                lst.TriggerClick.Handler = "if (index == 0) { this.clearValue();}";
                            }),
                            
                            HQ.Combo().ID("cboDistrict").Name("cboDistrict").HQProcedure("SA00000_pcDistrictByCountryState").HQLangCode("DISTRICT")
                            .HQColumnShow("District,Name").DisplayField("Name").ValueField("District").DataIndex("District")
                            .HQHeightWidth(400, 400).Width(600).MarginSpec("5 0 0 0")
                            .HQParam(new StoreParameterCollection() 
                            { 
                                new StoreParameter() { Name = "@Country", Value = "App.cboCountry.getValue()", Mode = ParameterMode.Raw },
                                new StoreParameter() { Name = "@State", Value = "App.cboState.getValue()", Mode = ParameterMode.Raw }
                            })
                            .LoadData()
                            .Triggers(new FieldTrigger() { Icon = TriggerIcon.Clear, HideTrigger = false })
                            .Listeners(lst =>
                            {
                                lst.TriggerClick.Handler = "if (index == 0) { this.clearValue();}";
                            }),             
                            
                            HQ.Combo().ID("cboCpnyType").Name("cboCpnyType").HQProcedure("SA00000_pcCpnyType").HQLangCode("CPNYTYPE")
                            .HQColumnShow("Code,Descr").DisplayField("Descr").ValueField("Code").DataIndex("CpnyType")
                            .HQHeightWidth(400, 400).Width(600).MarginSpec("5 0 0 0").HQDBSys(true)
                            .HQParam(new StoreParameterCollection() 
                            { 
                                new StoreParameter() { Name = "@langID", Value = "HQ.langID", Mode = ParameterMode.Raw }
                            })
                            .LoadData()
                            .Triggers(new FieldTrigger() { Icon = TriggerIcon.Clear, HideTrigger = false })
                            .Listeners(lst =>
                            {
                                lst.TriggerClick.Handler = "if (index == 0) { this.clearValue();}";
                            }),
                            
                            HQ.Combo().ID("cboType").Name("cboType").HQProcedure("SA00000_pcType").HQLangCode("SA00000TYPE")
                            .HQColumnShow("Code,Descr").DisplayField("Descr").ValueField("Code").DataIndex("Type")
                            .HQHeightWidth(400, 400).Width(600).MarginSpec("5 0 0 0")
                            .LoadData()
                            .Triggers(new FieldTrigger() { Icon = TriggerIcon.Clear, HideTrigger = false })
                            .Listeners(lst =>
                            {
                                lst.TriggerClick.Handler = "if (index == 0) { this.clearValue();}";
                            })                 
                            //,HQ.Combo().ID("Channel").Name("Channel").MarginSpec("3 0 0 0").AllowBlank(false)
                            //                        .HQLangCode("Channel").HQDBSys(false).HQProcedure("SA00000_pcSalesChannel")
                            //                        .HQColumnShow("Code,Descr")
                            //                        .DisplayField("Descr")
                            //                        .ValueField("Code")
                            //                        .HQHeightWidth(400, 300)
                            //                        .Triggers(new FieldTrigger() { Icon = TriggerIcon.Clear, HideTrigger = false })
                            //                        .Listeners(lst => { lst.TriggerClick.Handler = "if (index == 0) { this.clearValue();}";})
                            //                        .LoadData().Width(600)        
                            //,HQ.Checkbox().ID("Blocked").Name("Blocked").HQLangCode("Blocked").MarginSpec("3 0 0 205").Width(600)
                            //,HQ.DateField().ID("BlockedTime").Name("BlockedTime").HQLangCode("BlockedTime").MarginSpec("3 0 0 0").Width(600).HQControlFocus("")
                            //,HQ.Checkbox().ID("LoggedIn").Name("LoggedIn").HQLangCode("LoggedIn").MarginSpec("3 0 0 205").Width(600)
                            //,HQ.DateField().ID("LastLoggedIn").Name("LastLoggedIn").HQLangCode("LastLoggedIn").MarginSpec("3 0 0 0").Width(600).HQControlFocus("")
                            //,HQ.DateField().ID("BeginDay").Name("BeginDay").HQLangCode("BeginDay").MarginSpec("3 0 0 0").HQControlFocus("").Width(600)
                            //,HQ.NumberField().ID("ExpireDay").Name("ExpireDay").HQLangCode("ExpireDay").MarginSpec("3 0 0 0").HQControlFocus("").Width(600).AllowBlank(false)
                            //,HQ.NumberField().ID("FailedLoginCount").Name("FailedLoginCount").HQLangCode("FailedLoginCount").MarginSpec("3 0 0 0").HQControlFocus("").Width(600)
                            //,HQ.TextBox().ID("JobTitle").Name("JobTitle").HQLangCode("JobTitle").MarginSpec("3 0 0 0").HQControlFocus("").Width(600)
                            //,HQ.Combo().ID("Manager").Name("Manager").MarginSpec("3 0 0 0")
                            //                        .HQLangCode("Manager").HQDBSys(true).HQProcedure("SA00000_pcManager")
                            //                        .HQColumnShow("UserName,FirstName,LastName,Address,Email")
                            //                        .DisplayField("UserName")
                            //                        .ValueField("UserName")
                            //                        .HQHeightWidth(400, 300)
                            //                        .Triggers(new FieldTrigger() { Icon = TriggerIcon.Clear, HideTrigger = false })
                            //                        .Listeners(lst => { lst.TriggerClick.Handler = "if (index == 0) { this.clearValue();}";})
                            //                        .LoadData().Width(600)
                            //,HQ.Combo().ID("Department").Name("Department").MarginSpec("3 0 0 0")
                            //                        .HQLangCode("Department").HQDBSys(false).HQProcedure("SA00000_pcDepartment")
                            //                        .HQColumnShow("Department,Name")
                            //                        .DisplayField("Name")
                            //                        .ValueField("Department")
                            //                        .HQHeightWidth(400, 300)
                            //                        .Triggers(new FieldTrigger() { Icon = TriggerIcon.Clear, HideTrigger = false })
                            //                        .Listeners(lst => { lst.TriggerClick.Handler = "if (index == 0) { this.clearValue();}";})
                            //                        .LoadData().Width(600)
                            //,HQ.Checkbox().ID("CheckFirstLogin").Name("CheckFirstLogin").HQLangCode("CheckFirstLogin").MarginSpec("3 0 0 205")                                            
                            //,HQ.Combo().ID("HomeScreenNbr").Name("HomeScreenNbr")
                            //                        .HQLangCode("HomeScreenNbr").HQDBSys(true).HQProcedure("SA00000_pcSYS_Screen")
                            //                        .HQColumnShow("Code,Descr")
                            //                        .DisplayField("Descr")
                            //                        .ValueField("Code")
                            //                        .HQHeightWidth(400, 300)
                            //                        .Triggers(new FieldTrigger() { Icon = TriggerIcon.Clear, HideTrigger = false })
                            //                        .Listeners(lst => { lst.TriggerClick.Handler = "if (index == 0) { this.clearValue();}";})
                            //                        .LoadData().Width(600)
                            )

            )//pnlUser
            .Listeners(lss =>
            {
                lss.Render.Fn = "pnl_render";
            })

                , X.Panel().ID("pnlUserGroup")
                .Title(Util.GetLang("USERGROUP"))
                .Layout(LayoutType.Border)
                .Items(
                    //    X.GridPanel().ID("grdSYS_UserGroup")
                    //    .Scroll(ScrollMode.Both)
                    //    .View(X.GridView().TrackOver(false))
                    //    .Region(Region.Center).Flex(1)
                    //    .Store(
                    //         X.Store()
                    //        .ID("stoSYS_UserGroup")
                    //        .PageSize(50)//.AutoLoad(true)
                    //        .Model(Util.GenerateModel(typeof(SA00000_pgLoadSYS_UserGroup_Result), "mdlSYS_UserGroup", "GroupID"))
                    //        .Parameters(ps =>
                    //        {
                    //            ps.Add(new StoreParameter("UserID", "App.cboUserID.getValue()", ParameterMode.Raw));
                    //        })
                    //        .ServerProxy(X.AjaxProxy().Url(Url.Action("GetSYS_UserGroup")))
                    //        .Listeners(l =>
                    //        {
                    //            l.BeforeLoad.Handler = "HQ.common.showBusy(true,HQ.common.getLang(\"loadingdata\"));";
                    //            l.Load.Handler = ";HQ.common.showBusy(false);";
                    //        })
                    //    )
                    //    .Listeners(p => p.BoxReady.Handler = "App.stoSYS_UserGroup.reload();")
                    //    .SortableColumns(false)
                    //    .ColumnModel(
                    //        X.RowNumbererColumn()
                        
                    //        ,Html.X().Column().Text(Util.GetLang("GroupID")).DataIndex("GroupID").Width(120)
                    //        .Editor(
                    //            HQ.Combo().ID("cboGroupIDGroup").Name("cboGroupIDGroup")
                    //            .MarginSpec("3 0 0 0").HideLabel(true).LabelWidth(0)
                    //            .HQLangCode("GroupID").HQDBSys(true).HQProcedure("SA00000_pcUserGroup")
                    //            .HQColumnShow("GroupID,Descr")
                    //            .DisplayField("GroupID")
                    //            .ValueField("GroupID")
                    //            .HQHeightWidth(400, 300)
                    //            .Triggers(new FieldTrigger() { Icon = TriggerIcon.Clear, HideTrigger = false })
                    //            .Listeners(lst => 
                    //            { 
                    //                lst.TriggerClick.Handler = "if (index == 0) { this.clearValue();}"; 
                    //            })
                    //            .LoadData()            
                    //        )
                    //        ,Html.X().Column().Text(Util.GetLang("Descr")).DataIndex("Descr").Width(120) 

                    //        , X.CommandColumn().Width(150)
                    //        .Commands(
                    //            X.GridCommand()
                    //            .Text(("Reject"))
                    //            .ToolTip(t =>
                    //            {
                    //                t.Text = ("Rejectrowchanges");
                    //            })
                    //            .CommandName("reject")
                    //            .Icon(Icon.ArrowUndo)
                    //        )
                    //        .PrepareToolbar(t =>
                    //        {
                    //            t.Handler = "toolbar.items.get(0).setVisible(record.dirty);";
                    //        })
                    //        .Listeners(l =>
                    //        {
                    //            l.Command.Handler = "grdSYS_UserGroup_Reject(record);";
                    //        })
                    //)
                    //.SelectionModel(X.RowSelectionModel().ID("slmSYS_UserGroup")
                    //.Mode(SelectionMode.Multi))
                    //.BottomBar(
                    //    X.PagingToolbar()
                    //    .Items(
                    //        X.Label("Page size:"),
                    //        X.ToolbarSpacer(10),
                    //        X.ComboBox()
                    //        .Width(80)
                    //        .Items("1", "2", "10", "20", "30", "50")
                    //        .SelectedItems("50")
                    //        .Listeners(l => l.Select.Fn = "HQ.grid.onPageSelect")
                    //    )
                    //    .Plugins(X.ProgressBarPager())
                    //)
                    //.Plugins(
                    //    X.CellEditing()
                    //    .ClicksToEdit(1)
                    //    .Listeners(ls =>
                    //    {
                    //        ls.BeforeEdit.Fn = "grdSYS_UserGroup_BeforeEdit";
                    //        ls.Edit.Fn = "grdSYS_UserGroup_Edit";
                    //        ls.ValidateEdit.Fn = "grdSYS_UserGroup_ValidateEdit";
                    //    })
                    //)
                    //.Features(
                    //    X.GridFilters()
                    //        .Local(true)
                    //        .Filters(
                    //            X.StringFilter().DataIndex("GroupID")
                    //        )
                    //)
                )
                .Listeners(lss =>
                {
                    lss.Render.Fn = "pnl_render";
                })
        ////tabpnlUserGroup

        
                , X.Panel().ID("pnlUserCompany")
                .Title(Util.GetLang("CompanyGroup"))
                .Layout(LayoutType.Border)
                .CloseAction(CloseAction.Hide)
                .Items(
                    //X.GridPanel()
                    //.Scroll(ScrollMode.Both)
                    //.View(X.GridView().TrackOver(false))
                    //.ID("grdSYS_UserCompany")
                    //.Region(Region.Center).Flex(1)
                    //.Store(
                    //     X.Store()
                    //    .ID("stoSYS_UserCompany")
                    //    .PageSize(50)//.AutoLoad(true)
                    //    .Model(Util.GenerateModel(typeof(SA00000_pgLoadSYS_UserCompany_Result), "mdlSYS_UserCompany", "GroupID"))
                    //    .Parameters(ps =>
                    //    {
                    //        ps.Add(new StoreParameter("UserID", "App.cboUserID.getValue()", ParameterMode.Raw));
                    //    })
                    //    .ServerProxy(X.AjaxProxy().Url(Url.Action("GetSYS_UserCompany")))
                    //    .Listeners(l =>
                    //    {
                    //        l.BeforeLoad.Handler = "HQ.common.showBusy(true,HQ.common.getLang(\"loadingdata\"));";
                    //        l.Load.Handler = "HQ.common.showBusy(false);";
                    //    })
                    //)
                    //.Listeners(p => p.BoxReady.Handler = "App.stoSYS_UserCompany.reload();")
                    //.SortableColumns(false)
                    //.ColumnModel(
                    // X.RowNumbererColumn()
                        
                    //    , Html.X().Column().Text(Util.GetLang("GroupID")).DataIndex("GroupID").Width(120)
                    //        .Editor(
                    //            HQ.Combo().ID("cboGroupIDCompany").Name("cboGroupIDCompany")
                    //            .MarginSpec("3 0 0 0").HideLabel(true).LabelWidth(0)
                    //            .HQLangCode("GroupID").HQDBSys(true).HQProcedure("ppv_SA00000CompanyGroup")
                    //            .HQColumnShow("GroupID,Descr,ListCpny")
                    //            .DisplayField("GroupID")
                    //            .ValueField("GroupID")
                    //            .HQHeightWidth(400, 300)
                    //            .Triggers(new FieldTrigger() { Icon = TriggerIcon.Clear, HideTrigger = false })
                    //            .Listeners(lst => 
                    //            { 
                    //                lst.TriggerClick.Handler = "if (index == 0) { this.clearValue();}";
                    //            })
                    //            .LoadData()
                    //            )
                    //                            , Html.X().Column().Text(Util.GetLang("ListCpny")).DataIndex("ListCpny").Width(120)
                    //                            , Html.X().Column().Text(Util.GetLang("Descr")).DataIndex("Descr").Width(120)
                     
                    //    , X.CommandColumn().Width(150)
                    //    .Commands(
                    //        X.GridCommand()
                    //        .Text(("Reject"))
                    //        .ToolTip(t =>
                    //        {
                    //            t.Text = ("Rejectrowchanges");
                    //        })
                    //        .CommandName("reject")
                    //        .Icon(Icon.ArrowUndo)
                    //    )
                    //    .PrepareToolbar(t =>
                    //    {
                    //        t.Handler = "toolbar.items.get(0).setVisible(record.dirty);";
                    //    })
                    //    .Listeners(l =>
                    //    {
                    //        l.Command.Handler = "grdSYS_UserCompany_Reject(record);";
                    //    })
                    //)
                    //.SelectionModel(X.RowSelectionModel().ID("slmSYS_UserCompany").Mode(SelectionMode.Multi))
                    //.BottomBar(
                    //    X.PagingToolbar()
                    //    .Items(
                    //        X.Label("Page size:"),
                    //        X.ToolbarSpacer(10),
                    //        X.ComboBox()
                    //        .Width(80)
                    //        .Items("1", "2", "10", "20", "30", "50")
                    //        .SelectedItems("50")
                    //        .Listeners(l => l.Select.Fn = "HQ.grid.onPageSelect")
                    //    )
                    //    .Plugins(X.ProgressBarPager())
                    //)
                    //.Plugins(
                    //    X.CellEditing()
                    //    .ClicksToEdit(1)
                    //    .Listeners(ls =>
                    //    {
                    //        ls.BeforeEdit.Fn = "grdSYS_UserCompany_BeforeEdit";
                    //        ls.Edit.Fn = "grdSYS_UserCompany_Edit";
                    //        ls.ValidateEdit.Fn = "grdSYS_UserCompany_ValidateEdit";
                    //    })
                    //)
                    //.Features(
                    //    X.GridFilters()
                    //        .Local(true)
                    //        .Filters(
                    //            X.StringFilter().DataIndex("GroupID")
                    //        )
                    //)
                )
                .Listeners(lss =>
                {
                    lss.Render.Fn = "pnl_render";
                })//tabpnlUserCompany
        )//xtab
    )// frmMain
)
)
